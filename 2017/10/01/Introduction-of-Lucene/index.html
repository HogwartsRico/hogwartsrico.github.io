<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.4.0 -->
    <script>window.materialVersion = "1.4.0"</script>

    <!-- Title -->
    
    <title>
        
            Lucene入门 | 
        
        Rico&#39;s Blog
    </title>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
        <link rel="dns-prefetch" href="https://hm.baidu.com"/>
    
    
    
    
    
    
    

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="Rico">
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="Rico">

    <!-- Site Verification -->
    
    

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Rico&#39;s Blog">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://hogwartsrico.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Lucene入门 | Rico&#39;s Blog">
    <meta property="og:image" content="/img/favicon.png" />
    <meta property="og:description" content="">
    

    
        <meta property="article:published_time" content="10月 01, 2017" />
        <meta property="article:modified_time" content="4月 09, 2018" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="Lucene入门 | Rico&#39;s Blog">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="http://hogwartsrico.github.io" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://hogwartsrico.github.io/2017/10/01/Introduction-of-Lucene/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Rico&#39;s Blog",
        "logo": "/img/favicon.png"
    },
    "author": {
        "@type": "Person",
        "name": "Rico",
        "image": {
            "@type": "ImageObject",
            "url": "/img/favicon.png"
        },
        "description": "Javaer"
    },
    "headline": "Lucene入门",
    "url": "http://hogwartsrico.github.io/2017/10/01/Introduction-of-Lucene/index.html",
    "datePublished": "10月 01, 2017",
    "dateModified": "4月 09, 2018",
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://hogwartsrico.github.io"
    }
}
</script>


    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+materialVersion+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(data&&data.indexOf(versionString)===-1){lsloader.removeLS(key)}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload){cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload);return}code=code.split(versionString)[1];if(/\.js?.+$/.test(versionNumber)){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload)}};lsloader.requestResource=function(name,path,cssonload){var that=this;if(/\.js?.+$/.test(path)){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else if(/\.css?.+$/.test(path)){this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import CSS & jQuery -->
    
        <style id="css/material.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/material.min.css","/css/material.min.css?fJTiM/K1J3dWIruo3pxtAw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        <style id="css/style.min.css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("css/style.min.css","/css/style.min.css?oCSEO3ST+aEypEwttTDI9g==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";})</script>
        
        
            <style>
    
    .footer-sns-facebook {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHptNjU3LjYgODcuOGw0LjggMy44djU1LjJjMCA1NC42IDAgNTUuMi00LjYgNTkuNi00LjQgNC40LTYgNC42LTUwLjIgNS42bC00NS42IDEtNy4yIDUuNmMtMTAuNCA4LTE2LjggMTcuMi0xOS4yIDI3LjQtMSA1LTEuOCAyNC44LTEuOCA0NCAuMiAzOCAxLjYgNDQuNiAxMC44IDQ4IDIuOCAxLjIgMjguNCAyIDU2LjggMiA0Ny44IDAgNTIgLjIgNTYuMiAzLjhsNC44IDMuOHY1NS4yYzAgNTQuNiAwIDU1LjItNC42IDU5LjYtNC40IDQuNi01LjQgNC42LTU3IDUuMi0yOC44LjItNTQuNC44LTU2LjggMS40LTIuNC42LTUuNiAzLTYuOCA1LjQtMS44IDMuMi0yLjQgNDEuNC0yLjYgMTQzLjJsLS4yIDEzOC44LTUuNiA0LjgtNS42IDQuOEg2MDljLTUyLjQgMC01Mi44IDAtNTguMi00LjZsLTUuNC00LjYtLjItMTQwLjYtLjItMTQwLjYtNC44LTMuOGMtNC4yLTMuNC04LTMuOC0zNS42LTMuOC0zMi44IDAtNDEtMS44LTQzLjYtMTAtLjYtMi4yLTEuMi0yNS40LTEuMi01MS40IDAtNjAuOC0uMi01NyAzLjQtNjEuNiAyLjgtMy42IDYtNCAzNy44LTUgMzMtMSAzNS4yLTEuMiAzOS40LTUuNiA0LjYtNC40IDQuNi01LjIgNS44LTcxIDEuMi03My40LjItNjcuMiAxNi42LTk5LjQgOC0xNS44IDEyLjgtMjIgMjgtMzcgMTUuMi0xNS4yIDIxLjQtMTkuNiAzOC4yLTI4IDExLTUuNCAyNC0xMSAyOS0xMi4yIDYuMi0xLjggMjguNi0yLjYgNzEuMi0yLjYgNTguNi0uMiA2Mi42IDAgNjcgMy42eiIvPjwvc3ZnPg==);
    }
    
    
    .footer-sns-twitter {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHptNTMyLjggMjA1YzEwIDQgMjMgMTAuOCAyOC44IDE1LjIgMTIuNiA5LjIgMTYuNiAxMC42IDI5LjQgOS40IDYuNi0uNiAxMy0zLjIgMjAuNC04LjIgMTEuMi03LjYgMTkuNC05LjIgMjMuNi01IDMuNiAzLjYgMi44IDktMi44IDE4LjYtNy4yIDEyLjQtNiAxOC44IDQuMiAyNC4yIDQuNCAyLjIgOC4yIDUuNiA4LjYgNy40IDEgNC44LTEyLjYgMjQuMi0yMiAzMS44LTExLjggOS4yLTE3LjIgMjIuNi0xOS42IDQ3LjgtNC44IDUwLjQtNy44IDY2LjYtMTYuNCA4NS40LTMgNy03IDE3LjgtOC44IDI0LTEuOCA2LjQtNSAxNC42LTcuNCAxOC40LTIuMiAzLjgtNy40IDEzLTExLjQgMjAuNC0xNy4yIDMwLjgtNDMuNCA2MS40LTcxLjQgODMuOC0yNS42IDIwLjQtNDYgMzMuMi02NC4yIDQwLjItOC40IDMuMi0xOCA3LjYtMjEuNCA5LjYtNy40IDQuNi0yMi40IDguNi01Ny4yIDE1LTYyLjIgMTEuNi03OS4yIDExLjQtMTM1LjYtMS0zMi40LTctMzguNi05LTUyLTE2LjgtMjEuNC0xMi42LTI0LjItMTQuOC0yNC4yLTE5LjQgMC02LjIgMTAuMi05LjIgMzUtMTAuNCAyMi40LTEgMjguNi0yLjYgNTctMTQuMiAyMy44LTkuOCAyOS40LTEyLjggMzAuNC0xNi44IDIuMi04LjItMy0xMy4yLTI2LjgtMjUuNC0yNS44LTEzLjItMzIuMi0xOC40LTQzLjgtMzUuOC05LTEzLjYtMTAtMjEuMi0zLjYtMzMuNiA1LjQtMTAuOCAzLjYtMTUtMTEuOC0yNS40LTktNi0xNC0xMS42LTIwLjgtMjIuNi0yMy40LTM3LjgtMjUtNTAuOC03LjItNTkuOCA0LjgtMi40IDkuNC01LjQgMTAuMi02LjYgMi44LTQuMi0uNC0xNS42LTguNC0yOS0xMS42LTE5LjYtMTMuMi0yNS44LTEzLjItNTUuMiAwLTI4LjggMi42LTM3LjggMTItNDAuMiA5LTIuMiAxNC44IDEgMzUuNiAyMC4yIDI0LjggMjIuOCA0My42IDM2LjYgNjIuOCA0NS44IDggMy44IDE3LjggOS4yIDIyIDEyIDQuMiAyLjggMTQuOCA3IDIzLjQgOS4yIDguNiAyLjIgMjQuMiA2LjggMzQuOCAxMC4yIDEzLjQgNC40IDIzLjYgNi40IDMzIDYuNiAxMi44LjIgMTQuMi0uMiAxOC42LTUuNCA0LTQuOCA0LjgtNy44IDQuOC0xOS4yIDAtMTQuNCA1LjYtMzkuNiAxMS4yLTUwLjYgNC4yLTguNCAyOS4yLTM0LjIgMzkuOC00MS40IDcuOC01LjQgMzUuNi0xNiA1Mi0yMCAxNC4yLTMuNiAzMi42LTEuMiA1Mi40IDYuOHoiLz48L3N2Zz4=);
    }
    
    
    .footer-sns-gplus {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik0xMzguNiA3OGMtMjIuNCA1LjItNTUuOCA0MC4yLTYwLjYgNjMuNC0xLjQgNi40LTIgMTI5LjgtMS42IDM2Ny42LjYgMjk4LjYgMSAzNTguOCAzLjQgMzYzIDExIDIwLjIgMjEuNiAzMi40IDM3LjIgNDMgMTUgMTAuMiAxNy40IDExLjIgMzMgMTMgMTEuMiAxLjQgMTM2IDIgMzY1IDEuNiAzMTQtLjYgMzQ4LjYtMSAzNTUtMy44IDE1LjgtNy4yIDMzLjgtMjIgNDMuMi0zNS40IDUuMi03LjQgMTAuOC0xNi42IDEyLjYtMjAuNCAyLjgtNi40IDMuMi00MC44IDMuOC0zNTQgLjQtMjIzLS4yLTM1My40LTEuNC0zNjUtMi0xNy0yLjYtMTguNi0xMy0zNC04LjYtMTIuNi0xNC4yLTE4LjQtMjUuMi0yNS44LTcuOC01LjQtMTcuNC0xMS0yMS42LTEyLjQtNi0yLjItNzIuOC0yLjYtMzY1LjQtMi42LTE5Ni44LjItMzYxIC44LTM2NC40IDEuOHpNNDMwIDI5NS40YzQwLjYgMTUuNCA1Ni42IDIzLjggNzIuNiAzOC40IDYuOCA2LjIgNy4yIDE1LjIgMSAyMy40LTYuMiA4LTMzLjYgMzMuOC0zOSAzNi42LTUuNiAyLjgtMTcuNiAyLjgtMjMuMi0uMi0yLjQtMS4yLTguMi01LjItMTMtOC44LTExLjItOC42LTI0LjYtMTEuMi01NS4yLTExLjItMjcuNCAwLTQwLjYgMi42LTUyLjIgMTAuNC00LjQgMi44LTEyLjIgNy42LTE3LjIgMTAuNi0yMyAxMy4yLTUxLjQgNTUtNTUuOCA4Mi40LTIuNiAxNS42LTIuNCAzNC44LjIgNTEgMi44IDE3LjQgMTkuOCA0OC44IDM1LjIgNjUuMiAxNiAxNi42IDQ1IDMzLjYgNjIuOCAzNi42IDI2LjggNC40IDY1LjggMS42IDc5LjQtNS44IDIwLjYtMTEuNCAzMS0xOSA0MS0zMC40IDE4LjgtMjEuNiAyMy40LTM0LjIgMTUuNi00My44LTMuOC00LjgtNC40LTQuOC01MS01LjgtNjAuOC0xLjItNTYuMiAyLjItNTYuMi00My4yIDAtMzIuNC4yLTMzLjIgNC44LTM3IDQuNC0zLjYgOS0zLjggOTItMy44IDc5IDAgODcuOC40IDk0LjIgMy42IDExLjIgNS42IDEzIDExLjQgMTIuOCA0My40IDAgMjUuNC0uOCAzMC44LTcuNiA1OC00IDE2LjYtOS44IDM0LTEyLjYgMzktMi44IDUtOC4yIDE0LjItMTEuNiAyMC42LTguNCAxNS40LTI3LjIgMzYuOC00MC44IDQ2LjYtNS44IDQuNC0xMy44IDEwLjItMTcuNiAxMy4yLTMuOCAzLTExIDctMTYuMiA4LjgtNS4yIDEuOC0xNi4yIDYuNC0yNC40IDEwLTIyLjQgOS42LTM0LjggMTEuNi03MyAxMS42LTM3LjYuMi00Ny0xLjQtNzEtMTItOC4yLTMuNi0xNy42LTcuMi0yMC44LTgtMTUuOC0zLjgtNjctNDUuMi03Ny44LTYyLjgtMi4yLTMuOC03LjYtMTEuNi0xMS44LTE3LjItNC4yLTUuNC05LTE0LTEwLjYtMTktMS44LTQuOC02LjItMTYtMTAtMjQuOC0zLjYtOC44LTcuOC0yMi4yLTkuMi0yOS42LTMuMi0xOC44LTEuNC03OS40IDIuOC05MS40IDEzLjgtNDAuNiAzNS42LTc4IDU4LjgtMTAwLjIgMTQtMTMuNiA0Ny4yLTM2LjQgNTgtMzkuOCA0LjItMS40IDEzLjQtNS4yIDIwLjYtOC40IDIyLTEwIDMyLjgtMTEuNiA3Ni0xMSAzMy44LjYgNDAuNCAxLjIgNTAgNC44em0zNDAuOCA4MC44YzggMy42IDkuNiAxMS4yIDkuMiAzOS4yLS42IDM0LjQtLjYgMzQgNSAzOS42IDQuOCA1IDUuNCA1IDM3LjYgNSA0My40IDAgNDQuNC44IDQzLjIgMzYuMi0uOCAxNy0xLjIgMTguNC02LjQgMjMtNS40IDQuNi02LjYgNC44LTM3LjYgNC44LTMxLjIgMC0zMiAuMi0zNi44IDUtNS42IDUuNC01LjYgNC40LTUgNDEuMi40IDI2LjQuMiAyNy40LTQuNiAzMy00LjggNS42LTYgNS44LTI0LjQgNi40LTIwLjguOC0yOS42LTEuNC0zMy40LTguNC0xLjQtMi42LTItMTUuNi0xLjgtMzUuNi40LTMxLjIuNC0zMS42LTQuNi0zNi42cy01LjYtNS0zNi01Yy0xOC44IDAtMzMtLjgtMzYtMi4yLTcuNi0zLjYtOS42LTExLjItOC44LTMzLjguOC0yOC4yLjQtMjggNDEtMjggNDUuNCAwIDQ1LjQgMCA0NC42LTQyLjYtLjYtMzMtLjYtMzMgNS0zOC40IDQuNC00LjYgNi4yLTUgMjQuOC01IDExIDAgMjIuMiAxIDI1IDIuMnoiLz48L3N2Zz4=);
    }
    
    
    
    
    
    
    
    
    
</style>

        
        <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">


        <script>lsloader.load("js/jquery.min.js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==")</script>
    
    
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Analytics -->
    <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?54ee66f82cedec3c2b6b4ea942911185';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    
    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Lucene简介和创建索引初步"><span class="post-toc-number">1.</span> <span class="post-toc-text">Lucene简介和创建索引初步</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#搜索初步"><span class="post-toc-number">2.</span> <span class="post-toc-text">搜索初步</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#索引创建-域选项"><span class="post-toc-number">3.</span> <span class="post-toc-text">索引创建  域选项</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#存储域选项"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">存储域选项</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#索引域选项"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">索引域选项</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#索引的删除和更新"><span class="post-toc-number">4.</span> <span class="post-toc-text">索引的删除和更新</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#删除"><span class="post-toc-number">4.0.1.</span> <span class="post-toc-text">删除</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#更新"><span class="post-toc-number">4.0.2.</span> <span class="post-toc-text">更新</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#索引加权操作"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">索引加权操作</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#使用Luke工具查看索引"><span class="post-toc-number">5.</span> <span class="post-toc-text">使用Luke工具查看索引</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#对时间和日期进行索引"><span class="post-toc-number">6.</span> <span class="post-toc-text">对时间和日期进行索引</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#IndexReader的设计"><span class="post-toc-number">7.</span> <span class="post-toc-text">IndexReader的设计</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#使用reader进行删除"><span class="post-toc-number">8.</span> <span class="post-toc-text">使用reader进行删除</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Directory的几种操作方式"><span class="post-toc-number">9.</span> <span class="post-toc-text">Directory的几种操作方式</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#TermRange等基本操作"><span class="post-toc-number">10.</span> <span class="post-toc-text">TermRange等基本操作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#精确查询"><span class="post-toc-number">10.1.</span> <span class="post-toc-text">精确查询</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#范围查询"><span class="post-toc-number">10.2.</span> <span class="post-toc-text">范围查询</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#数字范围查询"><span class="post-toc-number">10.3.</span> <span class="post-toc-text">数字范围查询</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#其他常用Query查询"><span class="post-toc-number">11.</span> <span class="post-toc-text">其他常用Query查询</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#前缀匹配搜索"><span class="post-toc-number">11.1.</span> <span class="post-toc-text">前缀匹配搜索</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#通配符搜索"><span class="post-toc-number">11.2.</span> <span class="post-toc-text">通配符搜索</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#booleanQuery-连接多个子查询"><span class="post-toc-number">11.3.</span> <span class="post-toc-text">booleanQuery 连接多个子查询</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#PhraseQuery-短语查询"><span class="post-toc-number">11.4.</span> <span class="post-toc-text">PhraseQuery 短语查询</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#fuzzyQuery-模糊查询"><span class="post-toc-number">11.5.</span> <span class="post-toc-text">fuzzyQuery 模糊查询</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#QueryParse"><span class="post-toc-number">12.</span> <span class="post-toc-text">QueryParse</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#分页搜索"><span class="post-toc-number">13.</span> <span class="post-toc-text">分页搜索</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#再查询的方式"><span class="post-toc-number">13.1.</span> <span class="post-toc-text">再查询的方式</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#SearchAfter的方式"><span class="post-toc-number">13.2.</span> <span class="post-toc-text">SearchAfter的方式</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#分词器的原理"><span class="post-toc-number">14.</span> <span class="post-toc-text">分词器的原理</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#通过TokenStream显示分词"><span class="post-toc-number">15.</span> <span class="post-toc-text">通过TokenStream显示分词</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#通过TokenStream显示分词的详细信息"><span class="post-toc-number">16.</span> <span class="post-toc-text">通过TokenStream显示分词的详细信息</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#自定义分词器"><span class="post-toc-number">17.</span> <span class="post-toc-text">自定义分词器</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#中文分词介绍"><span class="post-toc-number">18.</span> <span class="post-toc-text">中文分词介绍</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#实现自定义同义词分词器"><span class="post-toc-number">19.</span> <span class="post-toc-text">实现自定义同义词分词器</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#自定义排序"><span class="post-toc-number">20.</span> <span class="post-toc-text">自定义排序</span></a></li></ol>
        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>
    





<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                Lucene入门
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Rico</strong>
        <span>10月 01, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=Lucene入门&url=http://hogwartsrico.github.io/2017/10/01/Introduction-of-Lucene/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=Lucene入门&url=http://hogwartsrico.github.io/2017/10/01/Introduction-of-Lucene/index.html&via=Rico" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://hogwartsrico.github.io/2017/10/01/Introduction-of-Lucene/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://hogwartsrico.github.io/2017/10/01/Introduction-of-Lucene/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="Lucene简介和创建索引初步"><a href="#Lucene简介和创建索引初步" class="headerlink" title="Lucene简介和创建索引初步"></a>Lucene简介和创建索引初步</h1><p>在全文索引工具中，都是由这三部分组成 </p>
<ol>
<li>索引部分</li>
<li>分词部分</li>
<li>搜索部分  </li>
</ol>
<p>HelloLucene.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloLucene</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">     * 建立索引</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createIndex</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="comment">//1. 创建Directory    索引存放位置：硬盘,内存</span></div><div class="line">        <span class="comment">//Directory directory=new RAMDirectory();//索引建在内存中</span></div><div class="line">        Directory directory= <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            directory = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"/Users/xxx/workspace/LuceneDemo/hellolucene/index"</span>));</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//2. 创建IndexWriter  通过IndexWriter来写我们的索引</span></div><div class="line">        IndexWriterConfig indexWriterConfig=<span class="keyword">new</span> IndexWriterConfig(Version.LUCENE_35,<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35));<span class="comment">//第一个参数是需要匹配的版本在2.9之后，Lucene不是全部兼容的了,第二个参数时分词器，我们这里创建了一个标准的分词器,里面也需要传入版本号</span></div><div class="line">        IndexWriter indexWriter=<span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">//3.5版本之前的Lucene创建IndexWriter是这样的</span></div><div class="line">            <span class="comment">//new IndexWriter(Directory d路径, Analyzer a分词器,boolean create是否每次都是重新创建索引 false会在原来的后面追加,MaxFieldLength mfl Filed域最大值)</span></div><div class="line">            indexWriter=<span class="keyword">new</span> IndexWriter(directory,indexWriterConfig);</div><div class="line">            <span class="comment">//3. 创建Document对象 (里面有标题，文档大小，文档路径，文档内容等等)</span></div><div class="line">            Document doc=<span class="keyword">null</span>;</div><div class="line">            File docDir=<span class="keyword">new</span> File(<span class="string">"/Users/xxx/workspace/LuceneDemo/hellolucene/doc"</span>);</div><div class="line">            <span class="keyword">for</span>(File file:docDir.listFiles())&#123;</div><div class="line">                <span class="comment">//3. 创建Document对象 (里面有标题，文档大小，文档路径，文档内容等等)</span></div><div class="line">                doc=<span class="keyword">new</span> Document();</div><div class="line">                <span class="comment">//4. 为Document添加Field</span></div><div class="line">                doc.add(<span class="keyword">new</span> Field(<span class="string">"content"</span>,<span class="keyword">new</span> FileReader(file)));<span class="comment">//内容 通过filereader读进来的内容默认是不存储的 如果要存储，需要把文件的内容转成字符串然后和下面的一样添加  </span></div><div class="line">                doc.add(<span class="keyword">new</span> Field(<span class="string">"filename"</span>,file.getName(),Field.Store.YES,Field.Index.NOT_ANALYZED));<span class="comment">//把文件名存储到硬盘中,文件名不需要分词</span></div><div class="line">                doc.add(<span class="keyword">new</span> Field(<span class="string">"path"</span>,file.getAbsolutePath(),Field.Store.YES,Field.Index.NOT_ANALYZED));<span class="comment">//需要存储，也不需要分词</span></div><div class="line">                <span class="comment">//5. 通过IndexWriter添加文档到索引中</span></div><div class="line">                indexWriter.addDocument(doc);</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;<span class="keyword">finally</span> &#123;<span class="comment">//indexWriter必须关闭</span></div><div class="line">            <span class="keyword">if</span>(indexWriter!=<span class="keyword">null</span>)&#123;</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    indexWriter.close();</div><div class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">                    e.printStackTrace();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>HelloLuceneTest.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.hikvison;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloLuceneTest</span> </span>&#123;</div><div class="line">    HelloLucene helloLucene=<span class="keyword">new</span> HelloLucene();</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCreateIndex</span><span class="params">()</span></span>&#123;</div><div class="line">        helloLucene.createIndex();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行完单元测试之后文件夹里多出来很多Lucene的文件，其中<code>segments_1</code>是段文件 Lucene首先会在段文件中找相应的索引信息    </p>
<p><img src="1.png" alt="">  </p>
<h1 id="搜索初步"><a href="#搜索初步" class="headerlink" title="搜索初步"></a>搜索初步</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">    * 搜索</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">searcher</span><span class="params">()</span></span>&#123;</div><div class="line">       <span class="comment">//1. 创建Directory</span></div><div class="line">       Directory directory= <span class="keyword">null</span>;</div><div class="line">       <span class="keyword">try</span> &#123;</div><div class="line">           directory = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"/Users/xxx/workspace/LuceneDemo/hellolucene/index"</span>));</div><div class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125;</div><div class="line">       <span class="comment">//2. 创建IndexReader</span></div><div class="line">       IndexReader indexReader=<span class="keyword">null</span>;</div><div class="line">       <span class="keyword">try</span> &#123;</div><div class="line">           indexReader=IndexReader.open(directory);</div><div class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125;</div><div class="line">       <span class="comment">//3. 根据IndexReader创建IndexSearch</span></div><div class="line">       IndexSearcher indexSearcher=<span class="keyword">new</span> IndexSearcher(indexReader);</div><div class="line">       <span class="comment">//创建parser来确定要搜索文件的内容,第二个参数表示搜索的域</span></div><div class="line">       QueryParser queryParser=<span class="keyword">new</span> QueryParser(Version.LUCENE_35,<span class="string">"content"</span>,<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35));<span class="comment">//第一个参数时版本,第二个参数时默认搜索域,第三个参数时分词器,其中分词器构造函数也需要版本</span></div><div class="line">       <span class="comment">//4. 创建搜索的Query 有很多Query，我们这里用最简单的QueryParser</span></div><div class="line">       <span class="comment">//根据QueryParser来创建Query 搜索域content中包含GIS的内容</span></div><div class="line">       Query query=<span class="keyword">null</span>;</div><div class="line">       <span class="keyword">try</span> &#123;</div><div class="line">           query=queryParser.parse(<span class="string">"OpenLayers"</span>);<span class="comment">//搜索的内容包含GIS的文档</span></div><div class="line">       &#125; <span class="keyword">catch</span> (ParseException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125;</div><div class="line">       <span class="comment">//5. 根据Search搜索并且返回TopDocs</span></div><div class="line">       TopDocs topDocs=<span class="keyword">null</span>;</div><div class="line">       <span class="keyword">try</span> &#123;</div><div class="line">           topDocs=indexSearcher.search(query,<span class="number">10</span>);<span class="comment">//第二个表示搜索几条</span></div><div class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125;</div><div class="line">       <span class="comment">//6. 根据TopDocs获取ScoreDoc对象</span></div><div class="line">       <span class="comment">//TopDocs中存着ScoreDoc,是评分对象</span></div><div class="line">       ScoreDoc[] scoreDoc=topDocs.scoreDocs;</div><div class="line">       <span class="keyword">for</span>(ScoreDoc sd:scoreDoc)&#123;</div><div class="line">           <span class="comment">//7. 根据Searcher和ScoreDoc对象获取具体的Document对象</span></div><div class="line">           Document document=<span class="keyword">null</span>;</div><div class="line">           <span class="keyword">try</span> &#123;</div><div class="line">               document=indexSearcher.doc(sd.doc);</div><div class="line">           &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">               e.printStackTrace();</div><div class="line">           &#125;</div><div class="line">           <span class="comment">//8. 根据Document对象获取需要的值</span></div><div class="line">           System.out.println(<span class="string">"文件名"</span>+document.get(<span class="string">"filename"</span>)+<span class="string">",文件路径"</span>+document.get(<span class="string">"path"</span>));</div><div class="line">       &#125;</div><div class="line"></div><div class="line"></div><div class="line">       <span class="comment">//9. 关闭IndexReader</span></div><div class="line">       <span class="keyword">try</span> &#123;</div><div class="line">           indexReader.close();</div><div class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h1 id="索引创建-域选项"><a href="#索引创建-域选项" class="headerlink" title="索引创建  域选项"></a>索引创建  域选项</h1><p>索引建立步骤</p>
<p>1创建Directory</p>
<p>2创建Writer</p>
<p>3创建文档并且添加索引</p>
<p>4查询索引的基本信息</p>
<p>5删除和更新索引</p>
<h2 id="存储域选项"><a href="#存储域选项" class="headerlink" title="存储域选项"></a>存储域选项</h2><p>Field.Store.YES表示会把这个域中的内容完全存储到文件中，方便进行还原  </p>
<p>Field.Store.YES表示不存储内容到文件中,但是可以被索引 ,此时内容无法被还原(doc.get) </p>
<h2 id="索引域选项"><a href="#索引域选项" class="headerlink" title="索引域选项"></a>索引域选项</h2><p><img src="2.png" alt=""></p>
<p><code>Field.Index.ANALYZED</code> 进行分词和索引，适用于标题，内容等</p>
<p><code>Field.Index.NOT_ANALYZED</code> 进行索引，但是不进行分词，如果身份证号，姓名，ID等，适用于精确搜索</p>
<p><code>Field.Index.ANALYZED_NO_NORMS</code>  进行分词但不存储norms信息,这个norms包括了创建索引时间和权值等信息   排序有自己内部的评分规则 norms里面有些是因素</p>
<p><code>Field.Index.NOT_ANALYZED_NO_NORMS</code>  不分词也不存储norms信息</p>
<p><code>Field.Index.NO</code> 不进行索引</p>
<p><img src="3.png" alt=""> </p>
<p><img src="4.png" alt=""></p>
<p>fnm保存着域的信息  </p>
<p>fdx和fdt保存着Store为YES的属性信息   </p>
<p>frq 保存着哪些出现多少次,哪些相同的单词出现多少次  </p>
<p>nrm存储评分信息  </p>
<p>prx偏移量  </p>
<p>tii和tis存储索引里面所有信息</p>
<p>任一文件被删除索引就失效 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexUtil</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> String[] ids=&#123;<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"5"</span>,<span class="string">"6"</span>&#125;;</div><div class="line">    <span class="keyword">private</span> String[] emails=&#123;<span class="string">"abc@qq.com"</span>,<span class="string">"def@sina.com"</span>,<span class="string">"ghi@gmail.com"</span>,<span class="string">"rico@foxmail.com"</span>,<span class="string">"jkl@163.com"</span>,<span class="string">"mno@outlook.com"</span>&#125;;</div><div class="line">    <span class="keyword">private</span> String[] content=&#123;</div><div class="line">            <span class="string">"The apple is a deciduous tree, generally standing,China is its biggest market"</span>,</div><div class="line">            <span class="string">"China, officially the People's Republic of China (PRC), is a unitary sovereign state in East Asia"</span>,</div><div class="line">            <span class="string">"Donald John Trump (born June 14, 1946) is the 45th and current President of the United States, in office since January 20, 2017. Before entering politics, he was a businessman and television personality.He comes to China at 2017.10"</span>,</div><div class="line">            <span class="string">"Bees are flying insects closely related to wasps and ants,"</span>,</div><div class="line">            <span class="string">"Kotlin is a statically-typed programming language that runs on the Java virtual machine and also can be compiled to JavaScript source code or use the LLVM compiler infrastructure"</span>,</div><div class="line">            <span class="string">"he Yangtze , which is 6380 km long, is the longest river in Asia and the third-longest in the world"</span></div><div class="line">    &#125;;<span class="comment">//邮件内容</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] attachs=&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">5</span>&#125;;<span class="comment">//附件数量</span></div><div class="line">    <span class="keyword">private</span> String[] names=&#123;<span class="string">"rico"</span>,<span class="string">"tom"</span>,<span class="string">"linda"</span>,<span class="string">"jake"</span>,<span class="string">"rose"</span>,<span class="string">"hanmeimei"</span>&#125;;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Directory directory=<span class="keyword">null</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IndexUtil</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">//创建Directory</span></div><div class="line">            directory= FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"/Users/xxx/workspace/LuceneDemo/lucene_index/index"</span>));</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">index</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        IndexWriter indexWriter=<span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">//创建IndexWriter</span></div><div class="line">            indexWriter=<span class="keyword">new</span> IndexWriter(directory,<span class="keyword">new</span> IndexWriterConfig(Version.LUCENE_35,<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35)));</div><div class="line">            Document doc=<span class="keyword">null</span>;<span class="comment">//Document相当于数据库表里的每一条记录 域相当于表中的每一个字段</span></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;ids.length;i++)&#123;</div><div class="line">                doc=<span class="keyword">new</span> Document();<span class="comment">//创建文档</span></div><div class="line">                <span class="comment">//域存储选项和域索引选项</span></div><div class="line">                doc.add(<span class="keyword">new</span> Field(<span class="string">"id"</span>,ids[i],Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS));<span class="comment">//Field相当于一个字段   Field.Store.YES表示是否把数据存储在索引里,将来可以把数据进行还原,id一般都要存储,邮件地址也要存储,内容不需要存储  id不需要分词也不需要加权</span></div><div class="line">                doc.add(<span class="keyword">new</span> Field(<span class="string">"email"</span>,emails[i],Field.Store.YES,Field.Index.NOT_ANALYZED));<span class="comment">//不分词，要加权</span></div><div class="line">                doc.add(<span class="keyword">new</span> Field(<span class="string">"content"</span>,content[i],Field.Store.NO,Field.Index.ANALYZED));<span class="comment">//要分词</span></div><div class="line">                doc.add(<span class="keyword">new</span> Field(<span class="string">"names"</span>,names[i],Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS));</div><div class="line">                indexWriter.addDocument(doc);</div><div class="line">              	indexReader.close();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;<span class="keyword">finally</span> &#123;</div><div class="line">            <span class="keyword">if</span>(indexWriter!=<span class="keyword">null</span>)&#123;</div><div class="line">                indexWriter.close();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span></span>&#123;</div><div class="line">        IndexReader indexReader=<span class="keyword">null</span>;<span class="comment">//使用IndexReader进行查询</span></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            indexReader=IndexReader.open(directory);</div><div class="line">            System.out.println(<span class="string">"存储的doc数: "</span>+indexReader.numDocs());</div><div class="line">            System.out.println(<span class="string">"doc的总数: "</span>+indexReader.maxDoc());</div><div class="line">          	indexReader.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="索引的删除和更新"><a href="#索引的删除和更新" class="headerlink" title="索引的删除和更新"></a>索引的删除和更新</h1><h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        IndexWriter indexWriter=<span class="keyword">null</span>;</div><div class="line"></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            indexWriter=<span class="keyword">new</span> IndexWriter(directory,<span class="keyword">new</span> IndexWriterConfig(Version.LUCENE_35,<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35)));</div><div class="line">            <span class="comment">//参数时一个选项，可以使一个query,query的结果可能是系列结果,可以把一系列全部删除  也可以是term  term是精确查找的值</span></div><div class="line">            indexWriter.deleteDocuments(<span class="keyword">new</span> Term(<span class="string">"id"</span>,<span class="string">"1"</span>));<span class="comment">//删除id为1的</span></div><div class="line"> 			indexWriter.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;<span class="keyword">finally</span> &#123;</div><div class="line">            <span class="keyword">if</span>(indexWriter!=<span class="keyword">null</span>)&#123;</div><div class="line">                indexWriter.close();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       IndexUtil indexUtil=<span class="keyword">new</span> IndexUtil();</div><div class="line">       indexUtil.delete();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>删除完之后再查询一下 </p>
<p><img src="5.png" alt=""> </p>
<p>Lucene像Windows一样，有回收站，删除的文档并不会完全删除,删完存储在回收站里面,删错了可以从回收站里恢复的,实际只有5个了，而且回收站里的搜索不了,删完之后索引文件多了一个<code>.del</code>   文件,删除的都在里面  </p>
<p><img src="6.png" alt=""> </p>
<p>query里面加一行<code>System.out.println(&quot;删除的文档数:&quot;+indexReader.numDeletedDocs());</code>可以输出删除的文档数目  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recovery</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//使用IndexReader来恢复</span></div><div class="line">        IndexReader reader= <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            reader = IndexReader.open(directory);</div><div class="line">            reader.undeleteAll();</div><div class="line">            reader.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>运行报错了</p>
<p><img src="7.png" alt=""></p>
<p>是read only 如果是true，无法恢复 read本用于读的，所以默认readonly为true我们改为false  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recovery</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//使用IndexReader来恢复</span></div><div class="line">        IndexReader reader= <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            reader = IndexReader.open(directory,<span class="keyword">false</span>);<span class="comment">//第二个参数是read only 如果是true，无法恢复 read本用于读的，所以默认readonly为true</span></div><div class="line">            reader.undeleteAll();</div><div class="line">            reader.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>我们执行一遍恢复再执行一遍查询 </p>
<p><img src="8.png" alt="">  </p>
<p>而且目录下<code>.del</code>文件也删除了  </p>
<p>那么我们如何彻底删除 呢？ </p>
<p>3.5版本之前IndexWriter有个方法<code>optimize</code> (优化),但是已经被废弃了，因为一旦优化就要全部更新索引,负载很大,现在是<code>forceMerge</code></p>
<p>我们再执行一下删除方法,然后再执行一下下面的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">forceDelete</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        IndexWriter indexWriter=<span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            indexWriter=<span class="keyword">new</span> IndexWriter(directory,<span class="keyword">new</span> IndexWriterConfig(Version.LUCENE_35,<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35)));</div><div class="line">            indexWriter.forceMergeDeletes();</div><div class="line">            indexWriter.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;<span class="keyword">finally</span> &#123;</div><div class="line">            <span class="keyword">if</span>(indexWriter!=<span class="keyword">null</span>)&#123;</div><div class="line">                indexWriter.close();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p><img src="9.png" alt="">  </p>
<p>这样就彻底删除了  </p>
<p>当我们索引超出一定量的时候，Lucene会自动帮我们优化的,当然我们也可以手动强制更新   </p>
<p><code>indexWriter.deleteAll();</code>可以立即彻底删除所有索引 </p>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>更新前</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">存储的doc数: 6</div><div class="line">doc的总数: 6</div><div class="line">删除的文档数:0</div></pre></td></tr></table></figure>
<p>更新的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">        IndexWriter indexWriter=<span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            indexWriter=<span class="keyword">new</span> IndexWriter(directory,<span class="keyword">new</span> IndexWriterConfig(Version.LUCENE_35,<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35)));</div><div class="line">            <span class="comment">/*Lucene并没有提供更新方法,这里的更新操作其实是2个操作的集合</span></div><div class="line"><span class="comment">            *先删除之后再添加</span></div><div class="line"><span class="comment">            */</span></div><div class="line">            Document doc=<span class="keyword">new</span> Document();</div><div class="line">            doc.add(<span class="keyword">new</span> Field(<span class="string">"id"</span>,<span class="string">"11"</span>,Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS));<span class="comment">//Field相当于一个字段   Field.Store.YES表示是否把数据存储在索引里,将来可以把数据进行还原,id一般都要存储,邮件地址也要存储,内容不需要存储  id不需要分词也不需要加权</span></div><div class="line">            doc.add(<span class="keyword">new</span> Field(<span class="string">"email"</span>,emails[<span class="number">0</span>],Field.Store.YES,Field.Index.NOT_ANALYZED));<span class="comment">//不分词，要加权</span></div><div class="line">            doc.add(<span class="keyword">new</span> Field(<span class="string">"content"</span>,content[<span class="number">0</span>],Field.Store.NO,Field.Index.ANALYZED));<span class="comment">//要分词</span></div><div class="line">            doc.add(<span class="keyword">new</span> Field(<span class="string">"names"</span>,names[<span class="number">0</span>],Field.Store.YES,Field.Index.NOT_ANALYZED_NO_NORMS));</div><div class="line">            indexWriter.updateDocument(<span class="keyword">new</span> Term(<span class="string">"id"</span>,<span class="string">"1"</span>),doc);<span class="comment">//第一个参数：匹配的Term 第二个新传入Document</span></div><div class="line">            <span class="comment">//其实是先把id为1的进行删除,</span></div><div class="line">            indexWriter.close();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;<span class="keyword">finally</span> &#123;</div><div class="line">            <span class="keyword">if</span>(indexWriter!=<span class="keyword">null</span>)&#123;</div><div class="line">                indexWriter.close();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>更新后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">存储的doc数: 6</div><div class="line">doc的总数: 7</div><div class="line">删除的文档数:1</div></pre></td></tr></table></figure>
<p>说明了更新的确是先删除再增加  </p>
<p>总结：删除</p>
<p><img src="10.png" alt=""> 存到回收站中</p>
<p>恢复删除  <code>IndexReader.undeleteAll</code>  </p>
<p>强制删除 3.5之前<code>optimize</code> 之后 <code>forceMergeDelete</code>  </p>
<p>优化合并 (不建议使用) </p>
<p><code>writer.forceMerge(2)</code> </p>
<p>更新索引(先删除后添加)</p>
<p><img src="11.png" alt=""> </p>
<h2 id="索引加权操作"><a href="#索引加权操作" class="headerlink" title="索引加权操作"></a>索引加权操作</h2><p>在建索引的时候可以为文档加权 </p>
<p><code>doc.setBoost();//默认是1.0 值越高说明加权值也就越高，得分越高,排序越靠前</code> </p>
<p>搜索的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">search</span><span class="params">()</span></span>&#123;</div><div class="line">        IndexReader indexReader=<span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            indexReader=IndexReader.open(directory);</div><div class="line">            IndexSearcher searcher=<span class="keyword">new</span> IndexSearcher(indexReader);</div><div class="line">            TermQuery termQuery=<span class="keyword">new</span> TermQuery(<span class="keyword">new</span> Term(<span class="string">"content"</span>,<span class="string">"china"</span>));<span class="comment">//搜索content字段中包含China的</span></div><div class="line">            TopDocs tds=searcher.search(termQuery,<span class="number">10</span>);<span class="comment">//搜索前10条</span></div><div class="line">            <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">               Document doc=searcher.doc(sd.doc);</div><div class="line">               System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>重新删除索引，重建索引，然后运行搜索的测试用例</p>
<p>结果 </p>
<p><img src="12.png" alt=""></p>
<p>tom的排名第一，然后是rico的，然后是linda </p>
<p>为什么这么排序呢？ </p>
<p>我们看一下数据发现  tom的content里面出现了多次china</p>
<p><img src="13.png" alt=""> </p>
<p>所以他排名高一点，那么后面2位的排名为什么这么排我们就不得而知了    </p>
<p>接着我们加入评分  </p>
<p><img src="14.png" alt="">  </p>
<p>再运行搜索，结果  </p>
<p><img src="15.png" alt=""> </p>
<p>这是因为qq.com的权重高,gmail的次之</p>
<h1 id="使用Luke工具查看索引"><a href="#使用Luke工具查看索引" class="headerlink" title="使用Luke工具查看索引"></a>使用Luke工具查看索引</h1><p><img src="16.png" alt=""></p>
<p><img src="17.png" alt=""> </p>
<p>norm是加权信息  分数 这里我们存储了email  id  names  没有存储content</p>
<p>创建索引时我们没有对email分词，所以这里显示的也的确是没有分词 </p>
<p><img src="18.png" alt=""> </p>
<h1 id="对时间和日期进行索引"><a href="#对时间和日期进行索引" class="headerlink" title="对时间和日期进行索引"></a>对时间和日期进行索引</h1><p><img src="19.png" alt=""> </p>
<p>name是String,value还是String，所以不能用Field,要用NumberField  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">doc.add(<span class="keyword">new</span> NumericField(<span class="string">"attach"</span>,Field.Store.YES,<span class="keyword">true</span>).setIntValue(attachs[i]));<span class="comment">//存储附件  存储,索引,不分词, 默认就不分词也没有权值，所以没有这个选项</span></div><div class="line">doc.add(<span class="keyword">new</span> NumericField(<span class="string">"date"</span>,Field.Store.YES,<span class="keyword">true</span>).setLongValue(dates[i].getTime()));<span class="comment">//存储日期 存储+索引(方便根据日期查找)</span></div></pre></td></tr></table></figure>
<p>拿到结果  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</div><div class="line">Long dateLong=Long.valueOf(doc.get(&quot;date&quot;));</div><div class="line">Date date= new Date(dateLong);</div><div class="line">String dateStr=sdf.format(date);//long型日期转成日期型  </div><div class="line">System.out.println(&quot;文档日期:&quot;+dateStr);</div></pre></td></tr></table></figure>
<p><img src="20.png" alt=""> </p>
<p>搜索到的doc获取其权值全为1，因为这不是设置的时候的doc,因为搜索结果是一个新的doc对象，把搜索结果赋过来,加权信息没有的，看权值要用luke查看</p>
<p><img src="21.png" alt=""> </p>
<p>scores一般和2个相关，一个是设置的权值，一个是文档出现的次数。 具体的评分规则很复杂 </p>
<p><img src="22.png" alt=""> </p>
<h1 id="IndexReader的设计"><a href="#IndexReader的设计" class="headerlink" title="IndexReader的设计"></a>IndexReader的设计</h1><p><code>IndexReader</code>和<code>IndexWriter</code>打开和关闭都是非常耗时的操作,特别是<code>IndexReader</code>   </p>
<p>所以IndexReader最好设计成单例的   </p>
<p>但是单例会存在一个问题: </p>
<p>就是在reader过程中，且reader没有关闭，indexwriter进行了数据的增删，reader搜索到的内容不受影响  </p>
<p><code>IndexReader.openIfChanged</code>能解决这个问题  </p>
<p>所以我们重写getSearcher方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span>  IndexSearcher <span class="title">getSearcher</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">if</span>(indexReader==<span class="keyword">null</span>)&#123;</div><div class="line">                indexReader=IndexReader.open(directory);</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                IndexReader newReader=IndexReader.openIfChanged(indexReader);<span class="comment">//如果索引改变了,返回新的IndexReader,没改变则返回null</span></div><div class="line">                <span class="keyword">if</span>(newReader!=<span class="keyword">null</span>)&#123;</div><div class="line">                    indexReader.close();<span class="comment">//旧的关闭</span></div><div class="line">                    indexReader=newReader;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span>  <span class="keyword">new</span> IndexSearcher(indexReader);</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>这样,id为1的删除了，而且reader也能获取新的值 </p>
<p><img src="23.png" alt=""></p>
<p>当IndexWriter也是单例的时候，在原来close的地方调用<code>writter.commit();</code>进行提交</p>
<h1 id="使用reader进行删除"><a href="#使用reader进行删除" class="headerlink" title="使用reader进行删除"></a>使用reader进行删除</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//reader也能删</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete2</span><span class="params">()</span></span>&#123;</div><div class="line">       IndexReader reader= <span class="keyword">null</span>;</div><div class="line">       <span class="keyword">try</span>&#123;</div><div class="line">           reader = IndexReader.open(directory,<span class="keyword">false</span>);<span class="comment">//外面静态全局的reader是只读的，我们这里new一个可写的</span></div><div class="line">           reader.deleteDocuments(<span class="keyword">new</span> Term(<span class="string">"id"</span>,<span class="string">"1"</span>));<span class="comment">//reader也可以删除文档</span></div><div class="line">           reader.close();<span class="comment">//一定要close才会提交(删除) </span></div><div class="line">       &#125; <span class="keyword">catch</span> (StaleReaderException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125; <span class="keyword">catch</span> (LockObtainFailedException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125; <span class="keyword">catch</span> (CorruptIndexException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">           e.printStackTrace();</div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p> 使用reader方式进行删除实际上是根据reader来new了一个writer进行删除操作的(原来的Lucene还有个<code>writer.getreader()</code>方法的，后来弃用了),这种删除方式直接就更新了reader里的索引信息了(不然还要<code>IndexReader.openIfChanged(indexReader)</code>)  </p>
<p>还可以按照存储时的序号来删,一般不这么做<code>reader.deleteDocument(int i);</code> </p>
<h1 id="Directory的几种操作方式"><a href="#Directory的几种操作方式" class="headerlink" title="Directory的几种操作方式"></a>Directory的几种操作方式</h1><p><img src="24.png" alt=""></p>
<p>Lucene3.5的api </p>
<p>Lucene7.1的api  </p>
<p> <a href="http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/Directory.html" target="_blank" rel="external">http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/Directory.html</a></p>
<p><img src="25.png" alt=""></p>
<p><img src="26.png" alt=""></p>
<p><img src="27.png" alt=""></p>
<p><img src="28.png" alt=""></p>
<p>Base class for Directory implementations that store index files in the file system. </p>
<p>There are currently three core subclasses:</p>
<ul>
<li><a href="http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/SimpleFSDirectory.html" target="_blank" rel="external"><code>SimpleFSDirectory</code></a> is a straightforward implementation using Files.newByteChannel. However, it has poor concurrent performance (multiple threads will bottleneck) as it synchronizes when multiple threads read from the same file.</li>
<li><a href="http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/NIOFSDirectory.html" target="_blank" rel="external"><code>NIOFSDirectory</code></a> uses java.nio’s FileChannel’s positional io when reading to avoid synchronization when reading from the same file. Unfortunately, due to a Windows-only <a href="http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6265734" target="_blank" rel="external">Sun JRE bug</a> this is a poor choice for Windows, but on all other platforms this is the preferred choice. Applications using <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html?is-external=true#interrupt--" target="_blank" rel="external"><code>Thread.interrupt()</code></a> or <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html?is-external=true#cancel-boolean-" target="_blank" rel="external"><code>Future.cancel(boolean)</code></a> should use <code>RAFDirectory</code> instead. See <a href="http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/NIOFSDirectory.html" target="_blank" rel="external"><code>NIOFSDirectory</code></a> java doc for details.</li>
<li><a href="http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/MMapDirectory.html" target="_blank" rel="external"><code>MMapDirectory</code></a> uses memory-mapped IO when reading. This is a good choice if you have plenty of virtual memory relative to your index size, eg if you are running on a 64 bit JRE, or you are running on a 32 bit JRE but your index sizes are small enough to fit into the virtual memory space. Java has currently the limitation of not being able to unmap files from user code. The files are unmapped, when GC releases the byte buffers. Due to <a href="http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4724038" target="_blank" rel="external">this bug</a> in Sun’s JRE, MMapDirectory’s <a href="http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/IndexInput.html#close--" target="_blank" rel="external"><code>IndexInput.close()</code></a> is unable to close the underlying OS file handle. Only when GC finally collects the underlying objects, which could be quite some time later, will the file handle be closed. This will consume additional transient disk usage: on Windows, attempts to delete or overwrite the files will result in an exception; on other platforms, which typically have a “delete on last close” semantics, while such operations will succeed, the bytes are still consuming space on disk. For many applications this limitation is not a problem (e.g. if you have plenty of disk space, and you don’t rely on overwriting files on Windows) but it’s still an important limitation to be aware of. This class supplies a (possibly dangerous) workaround mentioned in the bug report, which may fail on non-Sun JVMs.</li>
</ul>
<p>Unfortunately, because of system peculiarities, there is no single overall best implementation. Therefore, we’ve added the <a href="http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/FSDirectory.html#open-java.nio.file.Path-" target="_blank" rel="external"><code>open(java.nio.file.Path)</code></a> method, to allow Lucene to choose the best FSDirectory implementation given your environment, and the known limitations of each implementation. For users who have no reason to prefer a specific implementation, it’s best to simply use <a href="http://lucene.apache.org/core/7_1_0/core/org/apache/lucene/store/FSDirectory.html#open-java.nio.file.Path-" target="_blank" rel="external"><code>open(java.nio.file.Path)</code></a>. For all others, you should instantiate the desired implementation directly.</p>
<p><strong>NOTE:</strong> Accessing one of the above subclasses either directly or indirectly from a thread while it’s interrupted can close the underlying channel immediately if at the same time the thread is blocked on IO. The channel will remain closed and subsequent access to the index will throw a <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/channels/ClosedChannelException.html?is-external=true" target="_blank" rel="external"><code>ClosedChannelException</code></a>. Applications using <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html?is-external=true#interrupt--" target="_blank" rel="external"><code>Thread.interrupt()</code></a> or <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html?is-external=true#cancel-boolean-" target="_blank" rel="external"><code>Future.cancel(boolean)</code></a> should use the slower legacy <code>RAFDirectory</code> from the <code>misc</code> Lucene module instead.</p>
<p>SimpleFSDirectory开销是最小的，但是多线程支持不好  </p>
<p>NIO对于Windows支持不太好  </p>
<p>MMapDirectory对于64位的会快一点   </p>
<p>我们只要使用<code>FSDirectory.open</code>就可以了，Lucene会根据当前的运行环境自动选择最合适的Directory  </p>
<p>RAMDirectory 把索引存到内存中，好处：快  坏处：不能持久化  </p>
<p>也可以把已经持久化的存到内存里(<code>RAMDirectory(Directory dir)</code>) </p>
<h1 id="TermRange等基本操作"><a href="#TermRange等基本操作" class="headerlink" title="TermRange等基本操作"></a>TermRange等基本操作</h1><h2 id="精确查询"><a href="#精确查询" class="headerlink" title="精确查询"></a>精确查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//精确匹配查询</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByTerm</span><span class="params">(String field,String value,<span class="keyword">int</span> num)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       IndexSearcher indexSearcher=getSearcher();</div><div class="line">       Query query=<span class="keyword">new</span> TermQuery(<span class="keyword">new</span> Term(field,value));</div><div class="line">       TopDocs tds=indexSearcher.search(query,num);</div><div class="line">       System.out.println(<span class="string">"一共查询到"</span>+tds.totalHits+<span class="string">"条记录"</span>);</div><div class="line">       <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">           Document doc=indexSearcher.doc(sd.doc);</div><div class="line">           <span class="comment">//---输出----</span></div><div class="line">           System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" 权值:"</span>+doc.getBoost()+<span class="string">" 评分:"</span>+sd.score+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">           SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line">           Long dateLong=Long.valueOf(doc.get(<span class="string">"date"</span>));</div><div class="line">           Date date= <span class="keyword">new</span> Date(dateLong);</div><div class="line">           String dateStr=sdf.format(date);</div><div class="line">           System.out.println(<span class="string">"文档附件数量:"</span>+doc.get(<span class="string">"attach"</span>)+<span class="string">" 文档日期:"</span>+dateStr);</div><div class="line">       &#125;</div><div class="line">       indexSearcher.close();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSearch</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       searcherUtil.searchByTerm(<span class="string">"content"</span>,<span class="string">"i"</span>,<span class="number">3</span>);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><img src="29.png" alt="">  </p>
<p>我们只要求取3条，但是总共仍然有6条。说明总共查询出来的值(totalHits是总记录数)和我们传入的num一点关系都没有   </p>
<h2 id="范围查询"><a href="#范围查询" class="headerlink" title="范围查询"></a>范围查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//范围查询</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByTermRange</span><span class="params">(String field,String start,String end,<span class="keyword">int</span> num)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">    IndexSearcher indexSearcher=getSearcher();</div><div class="line">    Query query=<span class="keyword">new</span> TermRangeQuery(field,start,end,<span class="keyword">true</span>,<span class="keyword">true</span>);<span class="comment">//field start end 是否包含最底下的(includeLower) 是否包含最上面的(includeUpper)  可以理解为开区间闭区间</span></div><div class="line">    TopDocs tds=indexSearcher.search(query,num);</div><div class="line">    System.out.println(<span class="string">"一共查询到"</span>+tds.totalHits+<span class="string">"条记录"</span>);</div><div class="line">    <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">        Document doc=indexSearcher.doc(sd.doc);</div><div class="line">        <span class="comment">//---输出----</span></div><div class="line">        System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" 权值:"</span>+doc.getBoost()+<span class="string">" 评分:"</span>+sd.score+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">        SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line">        Long dateLong=Long.valueOf(doc.get(<span class="string">"date"</span>));</div><div class="line">        Date date= <span class="keyword">new</span> Date(dateLong);</div><div class="line">        String dateStr=sdf.format(date);</div><div class="line">        System.out.println(<span class="string">"文档附件数量:"</span>+doc.get(<span class="string">"attach"</span>)+<span class="string">" 文档日期:"</span>+dateStr);</div><div class="line">    &#125;</div><div class="line">    indexSearcher.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSearchByTermRange</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       searcherUtil.searchByTermRange(<span class="string">"id"</span>,<span class="string">"1"</span>,<span class="string">"3"</span>,<span class="number">10</span>);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><img src="30.png" alt=""> </p>
<p>当<code>Query query=new TermRangeQuery(field,start,end,true,false)</code> 结果是1,2 </p>
<p>当<code>Query query=new TermRangeQuery(field,start,end,false,true)</code> 结果是2,3</p>
<p>当<code>Query query=new TermRangeQuery(field,start,end,false,false)</code> 结果是2</p>
<p><code>searcherUtil.searchByTermRange(&quot;names&quot;,&quot;a&quot;,&quot;s&quot;,10);</code> 查询名字包含从a到s字母的  </p>
<p><img src="31.png" alt=""></p>
<p>tom没有，因为t在s后面 </p>
<h2 id="数字范围查询"><a href="#数字范围查询" class="headerlink" title="数字范围查询"></a>数字范围查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByNumricRange</span><span class="params">(String field,<span class="keyword">int</span> start ,<span class="keyword">int</span> end,<span class="keyword">int</span> num)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       IndexSearcher indexSearcher=getSearcher();</div><div class="line">       Query query=NumericRangeQuery.newIntRange(field,start,end,<span class="keyword">true</span>,<span class="keyword">true</span>);<span class="comment">//最后2个仍然是是否开闭区间(是否包含)</span></div><div class="line">       TopDocs tds=indexSearcher.search(query,num);</div><div class="line">       System.out.println(<span class="string">"一共查询到"</span>+tds.totalHits+<span class="string">"条记录"</span>);</div><div class="line">       <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">           Document doc=indexSearcher.doc(sd.doc);</div><div class="line">           <span class="comment">//---输出----</span></div><div class="line">           System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" 权值:"</span>+doc.getBoost()+<span class="string">" 评分:"</span>+sd.score+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">           SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line">           Long dateLong=Long.valueOf(doc.get(<span class="string">"date"</span>));</div><div class="line">           Date date= <span class="keyword">new</span> Date(dateLong);</div><div class="line">           String dateStr=sdf.format(date);</div><div class="line">           System.out.println(<span class="string">"文档附件数量:"</span>+doc.get(<span class="string">"attach"</span>)+<span class="string">" 文档日期:"</span>+dateStr);</div><div class="line">       &#125;</div><div class="line">       indexSearcher.close();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><img src="32.png" alt=""> </p>
<p>找到的文档的附件数量是从1到3的  </p>
<p>目前还没有按照附件数量进行排序，而是按照文档序号进行排序的  </p>
<h1 id="其他常用Query查询"><a href="#其他常用Query查询" class="headerlink" title="其他常用Query查询"></a>其他常用Query查询</h1><h2 id="前缀匹配搜索"><a href="#前缀匹配搜索" class="headerlink" title="前缀匹配搜索"></a>前缀匹配搜索</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//前缀搜索 匹配前缀</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByPrefix</span><span class="params">(String field,String value,<span class="keyword">int</span> nums)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       IndexSearcher indexSearcher=getSearcher();</div><div class="line">       Query query=<span class="keyword">new</span> PrefixQuery(<span class="keyword">new</span> Term(field,value));<span class="comment">//支持前缀搜索</span></div><div class="line">       TopDocs tds=indexSearcher.search(query,nums);</div><div class="line">       System.out.println(<span class="string">"一共查询到"</span>+tds.totalHits+<span class="string">"条记录"</span>);</div><div class="line">       <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">           Document doc=indexSearcher.doc(sd.doc);</div><div class="line">           <span class="comment">//---输出----</span></div><div class="line">           System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" 权值:"</span>+doc.getBoost()+<span class="string">" 评分:"</span>+sd.score+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">           SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line">           Long dateLong=Long.valueOf(doc.get(<span class="string">"date"</span>));</div><div class="line">           Date date= <span class="keyword">new</span> Date(dateLong);</div><div class="line">           String dateStr=sdf.format(date);</div><div class="line">           System.out.println(<span class="string">"文档附件数量:"</span>+doc.get(<span class="string">"attach"</span>)+<span class="string">" 文档日期:"</span>+dateStr);</div><div class="line">       &#125;</div><div class="line">       indexSearcher.close();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSearchByPrefix</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       searcherUtil.searchByPrefix(<span class="string">"names"</span>,<span class="string">"r"</span>,<span class="number">9</span>);<span class="comment">//搜索r开头的名字</span></div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><img src="33.png" alt=""> </p>
<p>结果依然没排序,因为权值在content里面  </p>
<p>也可以搜索content以”xx”开头的  </p>
<h2 id="通配符搜索"><a href="#通配符搜索" class="headerlink" title="通配符搜索"></a>通配符搜索</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//通配符搜索</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByWildCard</span><span class="params">(String field,String value,<span class="keyword">int</span> nums)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       IndexSearcher indexSearcher=getSearcher();</div><div class="line">       Query query=<span class="keyword">new</span> WildcardQuery(<span class="keyword">new</span> Term(field,value));<span class="comment">//支持前缀搜索</span></div><div class="line">       TopDocs tds=indexSearcher.search(query,nums);</div><div class="line">       System.out.println(<span class="string">"一共查询到"</span>+tds.totalHits+<span class="string">"条记录"</span>);</div><div class="line">       <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">           Document doc=indexSearcher.doc(sd.doc);</div><div class="line">           <span class="comment">//---输出----</span></div><div class="line">           System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" 权值:"</span>+doc.getBoost()+<span class="string">" 评分:"</span>+sd.score+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">           SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line">           Long dateLong=Long.valueOf(doc.get(<span class="string">"date"</span>));</div><div class="line">           Date date= <span class="keyword">new</span> Date(dateLong);</div><div class="line">           String dateStr=sdf.format(date);</div><div class="line">           System.out.println(<span class="string">"文档附件数量:"</span>+doc.get(<span class="string">"attach"</span>)+<span class="string">" 文档日期:"</span>+dateStr);</div><div class="line">       &#125;</div><div class="line">       indexSearcher.close();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSearchByWildCard</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       searcherUtil.searchByWildCard(<span class="string">"names"</span>,<span class="string">"r*"</span>,<span class="number">9</span>);<span class="comment">//*表示任意多个字符 ?表示一个字符</span></div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="booleanQuery-连接多个子查询"><a href="#booleanQuery-连接多个子查询" class="headerlink" title="booleanQuery 连接多个子查询"></a>booleanQuery 连接多个子查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//连接多个子查询</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByBoolean</span><span class="params">(<span class="keyword">int</span> nums)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       IndexSearcher indexSearcher=getSearcher();</div><div class="line">       BooleanQuery query=<span class="keyword">new</span> BooleanQuery();</div><div class="line">       <span class="comment">//query.add(new TermQuery(new Term("names","rico")), BooleanClause.Occur.MUST);//Occur.MUST意思是名字必须是rico</span></div><div class="line">       query.add(<span class="keyword">new</span> TermQuery(<span class="keyword">new</span> Term(<span class="string">"names"</span>,<span class="string">"rico"</span>)), BooleanClause.Occur.SHOULD);<span class="comment">//Occur.Should意思表示可以出现也可以不出现  </span></div><div class="line">       query.add(<span class="keyword">new</span> TermQuery(<span class="keyword">new</span> Term(<span class="string">"content"</span>,<span class="string">"china"</span>)), BooleanClause.Occur.MUST);<span class="comment">//要查询名字中有rico，且content中必须有china的</span></div><div class="line">       TopDocs tds=indexSearcher.search(query,nums);</div><div class="line">       System.out.println(<span class="string">"一共查询到"</span>+tds.totalHits+<span class="string">"条记录"</span>);</div><div class="line">       <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">           Document doc=indexSearcher.doc(sd.doc);</div><div class="line">           <span class="comment">//---输出----</span></div><div class="line">           System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" 权值:"</span>+doc.getBoost()+<span class="string">" 评分:"</span>+sd.score+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">           SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line">           Long dateLong=Long.valueOf(doc.get(<span class="string">"date"</span>));</div><div class="line">           Date date= <span class="keyword">new</span> Date(dateLong);</div><div class="line">           String dateStr=sdf.format(date);</div><div class="line">           System.out.println(<span class="string">"文档附件数量:"</span>+doc.get(<span class="string">"attach"</span>)+<span class="string">" 文档日期:"</span>+dateStr);</div><div class="line">       &#125;</div><div class="line">       indexSearcher.close();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testBooleanQuery</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       searcherUtil.searchByBoolean(<span class="number">9</span>);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><code>BooleanClause.Occur.MUST</code> 表示必须出现   </p>
<p><code>BooleanClause.Occur.SHOULD</code>表示可以出现也可以不出现   </p>
<p><code>BooleanClause.Occur.MUST_NOT</code>表示必须没有 </p>
<h2 id="PhraseQuery-短语查询"><a href="#PhraseQuery-短语查询" class="headerlink" title="PhraseQuery 短语查询"></a>PhraseQuery 短语查询</h2><p>对于中文搜索没什么用，对于英文搜索来说很有用   分词主要按照空格来分词  </p>
<p>以<code>i like football</code> 举例 </p>
<p><code>i football</code> 中间有1跳(slop) </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//短语搜索</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByPhrase</span><span class="params">(<span class="keyword">int</span> nums)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       IndexSearcher indexSearcher=getSearcher();</div><div class="line">       PhraseQuery query=<span class="keyword">new</span> PhraseQuery();</div><div class="line">       query.setSlop(<span class="number">1</span>);<span class="comment">//slop表示有几跳</span></div><div class="line">       <span class="comment">//第一个Term</span></div><div class="line">       query.add(<span class="keyword">new</span> Term(<span class="string">"content"</span>,<span class="string">"i"</span>));</div><div class="line">       <span class="comment">//产生距离后的第二个term</span></div><div class="line">       query.add(<span class="keyword">new</span> Term(<span class="string">"content"</span>,<span class="string">"apple"</span>));</div><div class="line">       TopDocs tds=indexSearcher.search(query,nums);</div><div class="line">       System.out.println(<span class="string">"一共查询到"</span>+tds.totalHits+<span class="string">"条记录"</span>);</div><div class="line">       <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">           Document doc=indexSearcher.doc(sd.doc);</div><div class="line">           <span class="comment">//---输出----</span></div><div class="line">           System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" 权值:"</span>+doc.getBoost()+<span class="string">" 评分:"</span>+sd.score+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">           SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line">           Long dateLong=Long.valueOf(doc.get(<span class="string">"date"</span>));</div><div class="line">           Date date= <span class="keyword">new</span> Date(dateLong);</div><div class="line">           String dateStr=sdf.format(date);</div><div class="line">           System.out.println(<span class="string">"文档附件数量:"</span>+doc.get(<span class="string">"attach"</span>)+<span class="string">" 文档日期:"</span>+dateStr);</div><div class="line">       &#125;</div><div class="line">       indexSearcher.close();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>搜索i中间一个字，然后apple 例如 i like apple   </p>
<p>文中的顺序也是按照add的顺序？待考证</p>
<h2 id="fuzzyQuery-模糊查询"><a href="#fuzzyQuery-模糊查询" class="headerlink" title="fuzzyQuery 模糊查询"></a>fuzzyQuery 模糊查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//模糊查询</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchByFuzzy</span><span class="params">(<span class="keyword">int</span> nums)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       IndexSearcher indexSearcher=getSearcher();</div><div class="line">       <span class="comment">//FuzzyQuery query=new FuzzyQuery(new Term("names","ri"),0.1f,0);</span></div><div class="line">       FuzzyQuery query=<span class="keyword">new</span> FuzzyQuery(<span class="keyword">new</span> Term(<span class="string">"names"</span>,<span class="string">"tam"</span>));</div><div class="line">       System.out.println(query.getMinSimilarity());<span class="comment">//获取最小相似度 这些参数少用，会影响效率的 意义也不大</span></div><div class="line">       System.out.println(query.getPrefixLength());<span class="comment">//距离</span></div><div class="line">       TopDocs tds=indexSearcher.search(query,nums);</div><div class="line">       System.out.println(<span class="string">"一共查询到"</span>+tds.totalHits+<span class="string">"条记录"</span>);</div><div class="line">       <span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs)&#123;</div><div class="line">           Document doc=indexSearcher.doc(sd.doc);</div><div class="line">           <span class="comment">//---输出----</span></div><div class="line">           System.out.println(<span class="string">"文档序号: "</span>+sd.doc+<span class="string">" 权值:"</span>+doc.getBoost()+<span class="string">" 评分:"</span>+sd.score+<span class="string">" id:"</span>+doc.get(<span class="string">"id"</span>)+<span class="string">" name: "</span>+doc.get(<span class="string">"names"</span>)+<span class="string">" email:"</span>+doc.get(<span class="string">"email"</span>));</div><div class="line">           SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line">           Long dateLong=Long.valueOf(doc.get(<span class="string">"date"</span>));</div><div class="line">           Date date= <span class="keyword">new</span> Date(dateLong);</div><div class="line">           String dateStr=sdf.format(date);</div><div class="line">           System.out.println(<span class="string">"文档附件数量:"</span>+doc.get(<span class="string">"attach"</span>)+<span class="string">" 文档日期:"</span>+dateStr);</div><div class="line">       &#125;</div><div class="line">       indexSearcher.close();</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><img src="34.png" alt=""> </p>
<p>查 <code>tam</code> 把tom查出来   ,因为是模糊查询，默认是1个距离 </p>
<p>这个模糊查询对中文搜索没有什么帮助 </p>
<h1 id="QueryParse"><a href="#QueryParse" class="headerlink" title="QueryParse"></a>QueryParse</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//通过Parse生成Query 搜索content中包含china的</span></div><div class="line">Query query=queryParser.parse(<span class="string">"china"</span>);</div></pre></td></tr></table></figure>
<p><img src="37.png" alt=""> </p>
<p><code>query=queryParser.parse(&quot;names:r*&quot;);//改变搜索域为names  并搜索names为r开头的</code> </p>
<p><img src="35.png" alt=""> </p>
<p><code>query=queryParser.parse(&quot;names:tom&quot;);//改变搜索域为names  并搜索names为rico的</code> </p>
<p><img src="36.png" alt=""> </p>
<p><code>Query query=queryParser.parse(&quot;longest river&quot;);</code>搜索内容中带有longest 或 river的 (只有longest ，只有river,两者都有)  </p>
<p><img src="38.png" alt=""> </p>
<p>同时匹配 使用关键词 AND</p>
<p><code>Query query=queryParser.parse(&quot;longest AND river&quot;);</code>   </p>
<p><img src="42.png" alt=""> </p>
<p>也可以将空格代表or改为代表and</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//改变空格的默认操作符(本来是or),以下可以改成AND,这样空格也是AND了</span></div><div class="line">   queryParser.setDefaultOperator(QueryParser.Operator.AND);</div><div class="line">   Query query=queryParser.parse(<span class="string">"longest river"</span>);</div></pre></td></tr></table></figure>
<p>这样搜索content既有longest也有river的   </p>
<p><img src="39.png" alt=""> </p>
<p>查询<code>@qq.com</code>结尾的email </p>
<p><code>Query query=queryParser.parse(&quot;email: *@qq.com&quot;);</code> </p>
<p>但是报错了  </p>
<p><img src="40.png" alt=""> </p>
<p>因为如果匹配任意开头，特定结尾的效率非常低，Lucene默认是关闭的，我们来打开它  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">queryParser.setAllowLeadingWildcard(<span class="keyword">true</span>);<span class="comment">//开启第一个字符的通配符匹配(默认关闭，因为效率比较低)</span></div><div class="line">Query query=queryParser.parse(<span class="string">"email: *@qq.com"</span>);</div></pre></td></tr></table></figure>
<p><img src="41.png" alt=""> </p>
<p><code>Query query=queryParser.parse(&quot;- names:linda  + china &quot;);</code> 匹配内容中有china 但是names不是linda的 </p>
<p><code>-names: linda</code>表示name field不是linda  china不需要加fieldName是因为content是默认搜索域   </p>
<p>注意加减号前后要加空格 ,且加减放在条件前面  </p>
<p><img src="43.png" alt=""> </p>
<p>这里把linda过滤掉了(linda的内容也有china)    </p>
<p>匹配一个区间</p>
<p><code>Query query=queryParser.parse(&quot;id:[1 TO 3]&quot;);</code>   匹配id从1到3 </p>
<p><img src="44.png" alt=""> </p>
<p>TO必须是大写，不能是小写，否则会报错  </p>
<p>开区间是中括号，闭区间是花括号   </p>
<p><code>Query query=queryParser.parse(&quot;id:{1 TO 3}&quot;);</code> </p>
<p><img src="45.png" alt=""> </p>
<p>短语匹配 </p>
<p>我们先来看 </p>
<p><code>Query query=queryParser.parse(&quot;i like&quot;);</code> 根据上面的只是，我们知道会匹配只有i  只有like 既有i也有like的 </p>
<p><img src="46.png" alt=""> </p>
<p>但是我想完全匹配i like连起来的情况  </p>
<p>可以这样写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Query query=queryParser.parse(<span class="string">"\"i like\""</span>);<span class="comment">// 反斜杠包起来表示一个短语</span></div></pre></td></tr></table></figure>
<p><img src="47.png" alt=""> </p>
<p><img src="48.png" alt=""> </p>
<p>对于queryParse还是content,在i和like中加多少个空格都当成是一个空格  </p>
<p><code>i  like=i like=i     like</code>  </p>
<p><code>Query query=queryParser.parse(&quot;\&quot;i  china\&quot;~1&quot;);</code>表示i和china中可以有一个单词  最后匹配了i like china  </p>
<p><img src="49.png" alt=""> </p>
<p>模糊查询 </p>
<p>我们把名字一个改成和rico差一个单词的rica  </p>
<p><code>Query query=queryParser.parse(&quot;names:rico~&quot;);</code>  模糊查询 可以有1个字母的不一样</p>
<p><img src="50.png" alt=""></p>
<p>没有办法匹配数字 ，上面的<code>Query query=queryParser.parse(&quot;id:{1 TO 3}&quot;);</code> 的id是string型的 </p>
<p>如要匹配数字，需要自己扩展parse(下节内容)  </p>
<h1 id="分页搜索"><a href="#分页搜索" class="headerlink" title="分页搜索"></a>分页搜索</h1><p>两种方式 再查询和3.5版本之后提供的searchAfter  </p>
<h2 id="再查询的方式"><a href="#再查询的方式" class="headerlink" title="再查询的方式"></a>再查询的方式</h2><p>视频中的例子： </p>
<p>首先将各个txt文件重新拷贝一份，并修改后缀名，多拷几分好做分页  </p>
<p><img src="51.png" alt=""> </p>
<p><img src="52.png" alt=""> </p>
<p>然后将这些文件全部加索引  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileIndexUtils</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Directory directory = <span class="keyword">null</span>;</div><div class="line">	<span class="keyword">static</span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			directory = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"d:/lucene/files/"</span>));</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Directory <span class="title">getDirectory</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> directory;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">index</span><span class="params">(<span class="keyword">boolean</span> hasNew)</span> </span>&#123;</div><div class="line">		IndexWriter writer = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			writer = <span class="keyword">new</span> IndexWriter(directory, <span class="keyword">new</span> IndexWriterConfig(Version.LUCENE_35, <span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35)));</div><div class="line">			<span class="keyword">if</span>(hasNew) &#123;</div><div class="line">				writer.deleteAll();</div><div class="line">			&#125;</div><div class="line">			File file = <span class="keyword">new</span> File(<span class="string">"d:/lucene/example"</span>);</div><div class="line">			Document doc = <span class="keyword">null</span>;</div><div class="line">			<span class="keyword">for</span>(File f:file.listFiles()) &#123;</div><div class="line">				doc = <span class="keyword">new</span> Document();</div><div class="line">				doc.add(<span class="keyword">new</span> Field(<span class="string">"content"</span>,<span class="keyword">new</span> FileReader(f)));<span class="comment">//不存储 </span></div><div class="line">				doc.add(<span class="keyword">new</span> Field(<span class="string">"filename"</span>,f.getName(),Field.Store.YES,Field.Index.NOT_ANALYZED));<span class="comment">//存储 分词 </span></div><div class="line">				doc.add(<span class="keyword">new</span> Field(<span class="string">"path"</span>,f.getAbsolutePath(),Field.Store.YES,Field.Index.NOT_ANALYZED));<span class="comment">//存储 不分词 </span></div><div class="line">				doc.add(<span class="keyword">new</span> NumericField(<span class="string">"date"</span>,Field.Store.YES,<span class="keyword">true</span>).setLongValue(f.lastModified()));<span class="comment">//日期  修改日期 存储，(不存在分词的概念)</span></div><div class="line">				doc.add(<span class="keyword">new</span> NumericField(<span class="string">"size"</span>,Field.Store.YES,<span class="keyword">true</span>).setIntValue((<span class="keyword">int</span>)(f.length()/<span class="number">1024</span>)));<span class="comment">//存储 转换成k </span></div><div class="line">				writer.addDocument(doc);</div><div class="line">			&#125;</div><div class="line">		&#125; <span class="keyword">catch</span> (CorruptIndexException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (LockObtainFailedException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">finally</span> &#123;</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				<span class="keyword">if</span>(writer!=<span class="keyword">null</span>) writer.close();</div><div class="line">			&#125; <span class="keyword">catch</span> (CorruptIndexException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>example是文件存放的地方  files是存放索引的地方  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">indexFile</span><span class="params">()</span> </span>&#123;</div><div class="line">	FileIndexUtils.index(<span class="keyword">true</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>分页查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchPage</span><span class="params">(String query,<span class="keyword">int</span> pageIndex,<span class="keyword">int</span> pageSize)</span> </span>&#123;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">		Directory dir = FileIndexUtils.getDirectory();</div><div class="line">		IndexSearcher searcher = getSearcher(dir);</div><div class="line">		QueryParser parser = <span class="keyword">new</span> QueryParser(Version.LUCENE_35,<span class="string">"content"</span>,<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35));</div><div class="line">		Query q = parser.parse(query);</div><div class="line">		TopDocs tds = searcher.search(q, <span class="number">500</span>);</div><div class="line">		ScoreDoc[] sds = tds.scoreDocs;</div><div class="line">		<span class="keyword">int</span> start = (pageIndex-<span class="number">1</span>)*pageSize;</div><div class="line">		<span class="keyword">int</span> end = pageIndex*pageSize;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=start;i&lt;end;i++) &#123;</div><div class="line">			Document doc = searcher.doc(sds[i].doc);</div><div class="line">			System.out.println(sds[i].doc+<span class="string">":"</span>+doc.get(<span class="string">"path"</span>)+<span class="string">"--&gt;"</span>+doc.get(<span class="string">"filename"</span>));</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		searcher.close();</div><div class="line">	&#125; <span class="keyword">catch</span> (org.apache.lucene.queryParser.ParseException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">	&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这种方式就是把所有数据查出来再来做处理  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSearchPage01</span><span class="params">()</span> </span>&#123;</div><div class="line">		su.searchPage(<span class="string">"java"</span>, <span class="number">2</span>,<span class="number">20</span>);<span class="comment">//第二页 每页20条数据  </span></div><div class="line">		System.out.println(<span class="string">"-------------------------------"</span>);</div><div class="line"><span class="comment">//		su.searchNoPage("java");</span></div><div class="line">		su.searchPageByAfter(<span class="string">"java"</span>, <span class="number">2</span>,<span class="number">20</span>);</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h2 id="SearchAfter的方式"><a href="#SearchAfter的方式" class="headerlink" title="SearchAfter的方式"></a>SearchAfter的方式</h2><p>3.5版本之后才出现 </p>
<p><img src="54.png" alt=""> </p>
<p>改造如下 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * 根据页码和分页大小获取上一次的最后一个ScoreDoc</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">private</span> ScoreDoc <span class="title">getLastScoreDoc</span><span class="params">(<span class="keyword">int</span> pageIndex,<span class="keyword">int</span> pageSize,Query query,IndexSearcher searcher)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">	<span class="keyword">if</span>(pageIndex==<span class="number">1</span>)<span class="keyword">return</span> <span class="keyword">null</span>;<span class="comment">//如果是第一页就返回空</span></div><div class="line">	<span class="keyword">int</span> num = pageSize*(pageIndex-<span class="number">1</span>);<span class="comment">//获取上一页的数量  第一页20 第二页就是40了 这样刚好能够包含上一页最后一个  假如最后翻到100页，那么最后是2000条,这样比每次num都是2000条效率高  </span></div><div class="line">	TopDocs tds = searcher.search(query, num);</div><div class="line">	<span class="keyword">return</span> tds.scoreDocs[num-<span class="number">1</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchPageByAfter</span><span class="params">(String query,<span class="keyword">int</span> pageIndex,<span class="keyword">int</span> pageSize)</span> </span>&#123;</div><div class="line">	<span class="keyword">try</span> &#123;</div><div class="line">		Directory dir = FileIndexUtils.getDirectory();</div><div class="line">		IndexSearcher searcher = getSearcher(dir);</div><div class="line">		QueryParser parser = <span class="keyword">new</span> QueryParser(Version.LUCENE_35,<span class="string">"content"</span>,<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35));</div><div class="line">		Query q = parser.parse(query);</div><div class="line">		<span class="comment">//先获取上一页的最后一个元素</span></div><div class="line">		ScoreDoc lastSd = getLastScoreDoc(pageIndex, pageSize, q, searcher);</div><div class="line">		<span class="comment">//通过最后一个元素搜索下页的pageSize个元素</span></div><div class="line">		TopDocs tds = searcher.searchAfter(lastSd,q, pageSize);</div><div class="line">		<span class="keyword">for</span>(ScoreDoc sd:tds.scoreDocs) &#123;</div><div class="line">			Document doc = searcher.doc(sd.doc);</div><div class="line">			System.out.println(sd.doc+<span class="string">":"</span>+doc.get(<span class="string">"path"</span>)+<span class="string">"--&gt;"</span>+doc.get(<span class="string">"filename"</span>));</div><div class="line">		&#125;</div><div class="line">		searcher.close();</div><div class="line">	&#125; <span class="keyword">catch</span> (org.apache.lucene.queryParser.ParseException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">	&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">		e.printStackTrace();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="53.png" alt="">  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSearchPage02</span><span class="params">()</span> </span>&#123;</div><div class="line">	su.searchPageByAfter(<span class="string">"java"</span>, <span class="number">3</span>,<span class="number">20</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="分词器的原理"><a href="#分词器的原理" class="headerlink" title="分词器的原理"></a>分词器的原理</h1><p>所有的分词器都要继承Analyzer</p>
<ul>
<li>SimpleAnalyzer  简单分词器 </li>
<li>WhiteSpaceAnalyzer  空格分词器  </li>
<li>StandardAnalyzer  标准分词器  </li>
<li>StopAnalyzer    停用词  </li>
</ul>
<p>TokenStream是一个很重要的方法 </p>
<p>“how are you thank you”这一个输入的字符串传入到分词器转换成—&gt;TokenStream 分词的一个流,里面保存着所有的分词信息  </p>
<p>TokenStream有2个实现类 </p>
<p>一个是Tokenizer :将一组数据划分为不同的语汇单元 (一个一个的单词,还会转化成小写)</p>
<p>一个是TokenFilter: </p>
<p><img src="56.png" alt=""></p>
<p><img src="55.png" alt=""> </p>
<p><img src="57.png" alt=""> </p>
<p><img src="58.png" alt=""> </p>
<h1 id="通过TokenStream显示分词"><a href="#通过TokenStream显示分词" class="headerlink" title="通过TokenStream显示分词"></a>通过TokenStream显示分词</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">    * 通过字符串和分词器来把分词信息输出出来</span></div><div class="line"><span class="comment">    * <span class="doctag">@param</span> str</span></div><div class="line"><span class="comment">    * <span class="doctag">@param</span> analyzer</span></div><div class="line"><span class="comment">    */</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">displayToken</span><span class="params">(String str, Analyzer analyzer)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">      TokenStream tokenStream= analyzer.tokenStream(<span class="string">"content"</span>,<span class="keyword">new</span> StringReader(str));<span class="comment">//第一个参数fieldName,我们这个例子里没意义，随便填 ,第二个参数Reader,我们这里是StringReader</span></div><div class="line">       <span class="comment">//创建一个属性，这个属性会添加到Stream中</span></div><div class="line">       CharTermAttribute charTermAttribute=tokenStream.addAttribute(CharTermAttribute.class);<span class="comment">//tokenStream相当于水流，CharTermAttribute相当于水杯，水杯丢进水流  CharTermAttribute用来装词汇的</span></div><div class="line">       <span class="keyword">while</span> (tokenStream.incrementToken())&#123;<span class="comment">//类似于迭代器  只要水杯不空</span></div><div class="line">           System.out.print(<span class="string">"["</span>+charTermAttribute+<span class="string">"]"</span>);</div><div class="line">       &#125;</div><div class="line">       System.out.println();<span class="comment">//换行</span></div><div class="line">       System.out.println(<span class="string">"-----------------------------------"</span>);</div><div class="line"></div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAnalyzer</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       Analyzer a1=<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a2=<span class="keyword">new</span> StopAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a3=<span class="keyword">new</span> SimpleAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a4=<span class="keyword">new</span> WhitespaceAnalyzer(Version.LUCENE_35);</div><div class="line">       String txt=<span class="string">"this is my house,i am  come from zhejiang shaoxing"</span>;</div><div class="line">       AnalyzerUtil.displayToken(txt,a1);</div><div class="line">       AnalyzerUtil.displayToken(txt,a2);</div><div class="line">       AnalyzerUtil.displayToken(txt,a3);</div><div class="line">       AnalyzerUtil.displayToken(txt,a4);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>结果   </p>
<p><img src="59.png" alt=""></p>
<p>StopAnalyzer停用词，把this is 给停用掉了  </p>
<p>SimpleAnalyzer是LetterTokenizer标点符号分词</p>
<p>WhitespaceAnalyzer是空格分词，以至于把<code>house,i</code>分在了一起 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[my][house][i][am][come][from][zhejiang][shaoxing]</div><div class="line">-----------------------------------</div><div class="line">[my][house][i][am][come][from][zhejiang][shaoxing]</div><div class="line">-----------------------------------</div><div class="line">[this][is][my][house][i][am][come][from][zhejiang][shaoxing]</div><div class="line">-----------------------------------</div><div class="line">[this][is][my][house,i][am][come][from][zhejiang][shaoxing]</div></pre></td></tr></table></figure>
<p>把txt改为</p>
<blockquote>
<p>String txt=”this is my house,i am  come from zhejiang shaoxing.My email is lucene@gmail.com.My QQ is 123456”;</p>
</blockquote>
<p>结果为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[my][house][i][am][come][from][zhejiang][shaoxing.my][email][lucene][gmail.com.my][qq][123456]</div><div class="line">-----------------------------------</div><div class="line">[my][house][i][am][come][from][zhejiang][shaoxing][my][email][lucene][gmail][com][my][qq]</div><div class="line">-----------------------------------</div><div class="line">[this][is][my][house][i][am][come][from][zhejiang][shaoxing][my][email][is][lucene][gmail][com][my][qq][is]</div><div class="line">-----------------------------------</div><div class="line">[this][is][my][house,i][am][come][from][zhejiang][shaoxing.My][email][is][lucene@gmail.com.My][QQ][is][123456]</div></pre></td></tr></table></figure>
<p>可以看到第一个标准分词器，数字有，邮箱对  </p>
<p>第二个停用词分词器把数字给停用了 ,邮箱也不对,成了2个词 </p>
<p>简单分词器数字没了  </p>
<p>接下来我们测中文  </p>
<blockquote>
<p>String txt=”我来自绍兴”;  </p>
</blockquote>
<p>结果 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[我][来][自][绍][兴]</div><div class="line">-----------------------------------</div><div class="line">[我来自绍兴]</div><div class="line">-----------------------------------</div><div class="line">[我来自绍兴]</div><div class="line">-----------------------------------</div><div class="line">[我来自绍兴]</div></pre></td></tr></table></figure>
<p>只有标准分词器是一个个拆开的，其他都在一起  </p>
<p>所以以上分词器对于中文分词全部不适用  </p>
<p>总结： 一个字符串由分词器来分词会产生一个TokenStream的流，里面存了大量的属性，可以通过<code>CharTermAttribute</code>来获取流里面的分词信息，所以我们获取流，然后把<code>CharTermAttribute</code>放进去</p>
<p>如何查看Stream里的偏移量和位置增量？下节课介绍   </p>
<h1 id="通过TokenStream显示分词的详细信息"><a href="#通过TokenStream显示分词的详细信息" class="headerlink" title="通过TokenStream显示分词的详细信息"></a>通过TokenStream显示分词的详细信息</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">displayAllTokenInfo</span><span class="params">(String str,Analyzer analyzer)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       TokenStream tokenStream=analyzer.tokenStream(<span class="string">"content"</span>,<span class="keyword">new</span> StringReader(str));</div><div class="line">       PositionIncrementAttribute positionIncrementAttribute=tokenStream.addAttribute(PositionIncrementAttribute.class);</div><div class="line">       OffsetAttribute offsetAttribute=tokenStream.addAttribute(OffsetAttribute.class);</div><div class="line">       CharTermAttribute charTermAttribute=tokenStream.addAttribute(CharTermAttribute.class);</div><div class="line">       TypeAttribute typeAttribute=tokenStream.addAttribute(TypeAttribute.class);</div><div class="line">       <span class="keyword">for</span>(;tokenStream.incrementToken();)&#123;</div><div class="line">           System.out.print(<span class="string">"位置增量:"</span>+positionIncrementAttribute.getPositionIncrement());</div><div class="line">           System.out.print(<span class="string">"单词信息:"</span>+charTermAttribute+<span class="string">"["</span>+offsetAttribute.startOffset()+<span class="string">","</span>+offsetAttribute.endOffset()+<span class="string">"]"</span>);</div><div class="line">           System.out.print(<span class="string">"类型:"</span>+typeAttribute.type());</div><div class="line">           System.out.println();<span class="comment">//换行;</span></div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">testDisplayAllTokenInfo</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       Analyzer a1=<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a2=<span class="keyword">new</span> StopAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a3=<span class="keyword">new</span> SimpleAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a4=<span class="keyword">new</span> WhitespaceAnalyzer(Version.LUCENE_35);</div><div class="line">       String txt=<span class="string">"how are you thank you"</span>;</div><div class="line">       AnalyzerUtil.displayAllTokenInfo(txt,a1);</div><div class="line">       System.out.println(<span class="string">"-------------------"</span>);</div><div class="line">       AnalyzerUtil.displayAllTokenInfo(txt,a2);</div><div class="line">       System.out.println(<span class="string">"-------------------"</span>);</div><div class="line">       AnalyzerUtil.displayAllTokenInfo(txt,a3);</div><div class="line">       System.out.println(<span class="string">"-------------------"</span>);</div><div class="line">       AnalyzerUtil.displayAllTokenInfo(txt,a4);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>结果: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">标准分词器</div><div class="line">位置增量:1单词信息:how[0,3]类型:&lt;ALPHANUM&gt;</div><div class="line">位置增量:2单词信息:you[8,11]类型:&lt;ALPHANUM&gt; 位置增量2  跳过了一个单词 are</div><div class="line">位置增量:1单词信息:thank[12,17]类型:&lt;ALPHANUM&gt;</div><div class="line">位置增量:1单词信息:you[18,21]类型:&lt;ALPHANUM&gt;</div><div class="line">-------------------</div><div class="line">停用词分词器</div><div class="line">位置增量:1单词信息:how[0,3]类型:word</div><div class="line">位置增量:2单词信息:you[8,11]类型:word    位置增量2  跳过了一个单词 are</div><div class="line">位置增量:1单词信息:thank[12,17]类型:word</div><div class="line">位置增量:1单词信息:you[18,21]类型:word</div><div class="line">-------------------</div><div class="line">简单分词器</div><div class="line">位置增量:1单词信息:how[0,3]类型:word</div><div class="line">位置增量:1单词信息:are[4,7]类型:word</div><div class="line">位置增量:1单词信息:you[8,11]类型:word</div><div class="line">位置增量:1单词信息:thank[12,17]类型:word</div><div class="line">位置增量:1单词信息:you[18,21]类型:word</div><div class="line">-------------------</div><div class="line">空格分词器</div><div class="line">位置增量:1单词信息:how[0,3]类型:word</div><div class="line">位置增量:1单词信息:are[4,7]类型:word</div><div class="line">位置增量:1单词信息:you[8,11]类型:word</div><div class="line">位置增量:1单词信息:thank[12,17]类型:word</div><div class="line">位置增量:1单词信息:you[18,21]类型:word</div></pre></td></tr></table></figure>
<p>PositionIncrementAttribute 位置增量  元素与元素之间的相隔多少词语 </p>
<p>OffsetAttribute 偏移量</p>
<p>CharTermAttribute 每一个分词的元素</p>
<p>TypeAttribute 这一个分词的类型 </p>
<p>TokenStream分词器做好处理之后得到的一个流，这个流中存储了分词的各种信息，可以通过TokenStream有效的获取到分词单元 </p>
<p>Tokenizer主要负责接收字符流Reader,将Reader进行分词操作,有如下实现类</p>
<p><img src="55.png" alt=""> </p>
<p>TokenFilter将各种各样的语汇单元进行过滤 </p>
<h1 id="自定义分词器"><a href="#自定义分词器" class="headerlink" title="自定义分词器"></a>自定义分词器</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MyStopAnalyzer</span> <span class="keyword">extends</span> <span class="title">Analyzer</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> Set stops;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyStopAnalyzer</span><span class="params">(String[] stopword)</span></span>&#123;</div><div class="line">        stops= StopFilter.makeStopSet(Version.LUCENE_35,stopword,<span class="keyword">true</span>);<span class="comment">//第三个参数:是否忽略大小写</span></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> TokenStream <span class="title">tokenStream</span><span class="params">(String s, Reader reader)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StopFilter(<span class="comment">//Filter链</span></div><div class="line">                Version.LUCENE_35,</div><div class="line">                <span class="keyword">new</span> LowerCaseFilter(Version.LUCENE_35,</div><div class="line">                        <span class="keyword">new</span> LetterTokenizer(Version.LUCENE_35,reader)</div><div class="line">                ),</div><div class="line">        stops);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMyStopTokenizer</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       Analyzer myStopAnalyzer=<span class="keyword">new</span> MyStopAnalyzer(<span class="keyword">new</span> String[]&#123;<span class="string">"i"</span>,<span class="string">"you"</span>&#125;);</div><div class="line">       String txt=<span class="string">"how are you thank you"</span>;</div><div class="line">       AnalyzerUtil.displayToken(txt,myStopAnalyzer);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>结果 </p>
<p><code>[how][are][thank]</code> 但是默认的StopAnalyzer are是过滤掉的。说明自定义之后原本默认的过滤词没有了 </p>
<p>接下来我们加入原来默认的过滤词 </p>
<p>通过<code>System.out.println(StopAnalyzer.ENGLISH_STOP_WORDS_SET);</code>可以获取到原来有哪些停用词 </p>
<p><code>[but, be, with, such, then, for, no, will, not, are, and, their, if, this, on, into, a, or, there, in, that, they, was, is, it, an, the, as, at, these, by, to, of]</code>  </p>
<p>现在我们把它们加上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MyStopAnalyzer</span> <span class="keyword">extends</span> <span class="title">Analyzer</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> Set stops;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyStopAnalyzer</span><span class="params">(String[] stopword)</span></span>&#123;</div><div class="line">        System.out.println(StopAnalyzer.ENGLISH_STOP_WORDS_SET);</div><div class="line">        stops= StopFilter.makeStopSet(Version.LUCENE_35,stopword,<span class="keyword">true</span>);<span class="comment">//第三个参数:是否忽略大小写</span></div><div class="line">        stops.addAll(StopAnalyzer.ENGLISH_STOP_WORDS_SET);<span class="comment">//加上原来默认的停用词</span></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> TokenStream <span class="title">tokenStream</span><span class="params">(String s, Reader reader)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StopFilter(<span class="comment">//Filter链</span></div><div class="line">                Version.LUCENE_35,</div><div class="line">                <span class="keyword">new</span> LowerCaseFilter(Version.LUCENE_35,</div><div class="line">                        <span class="keyword">new</span> LetterTokenizer(Version.LUCENE_35,reader)</div><div class="line">                ),</div><div class="line">        stops);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样结果就变为了 </p>
<p><code>[how][thank]</code> </p>
<h1 id="中文分词介绍"><a href="#中文分词介绍" class="headerlink" title="中文分词介绍"></a>中文分词介绍</h1><p>庖丁解牛分词器 —已经停止更新了 </p>
<p>mmseg:使用搜狗的词库</p>
<p><a href="https://github.com/chenlb/mmseg4j-from-googlecode" target="_blank" rel="external">Mmseg github</a> </p>
<p>pom中加入下面的引用 </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.chenlb.mmseg4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mmseg4j-dic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.chenlb.mmseg4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mmseg4j-analysis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<p>上一节的例子加入mmseg的Analyzer </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Test</span></div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAnalyzer02</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">       Analyzer a1=<span class="keyword">new</span> StandardAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a2=<span class="keyword">new</span> StopAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a3=<span class="keyword">new</span> SimpleAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a4=<span class="keyword">new</span> WhitespaceAnalyzer(Version.LUCENE_35);</div><div class="line">       Analyzer a5=<span class="keyword">new</span> MMSegAnalyzer();</div><div class="line">       <span class="comment">//Analyzer a6=new MMSegAnalyzer();</span></div><div class="line">       String txt=<span class="string">"我来自绍兴,我爱喝女儿红"</span>;</div><div class="line">       AnalyzerUtil.displayToken(txt,a1);</div><div class="line">       AnalyzerUtil.displayToken(txt,a2);</div><div class="line">       AnalyzerUtil.displayToken(txt,a3);</div><div class="line">       AnalyzerUtil.displayToken(txt,a4);</div><div class="line">       AnalyzerUtil.displayToken(txt,a5);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>结果 </p>
<p><img src="60.png" alt=""> </p>
<h1 id="实现自定义同义词分词器"><a href="#实现自定义同义词分词器" class="headerlink" title="实现自定义同义词分词器"></a>实现自定义同义词分词器</h1><h1 id="自定义排序"><a href="#自定义排序" class="headerlink" title="自定义排序"></a>自定义排序</h1>
    

    
</div>


                
		<!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/09/01/proxy-in-Spring/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/09/22/Introduction-of-ElasticSearch/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.jpg" alt="Rico's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        chenhongjie101@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2019/10/">十月 2019<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/05/">五月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/03/">三月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/02/">二月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/01/">一月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/04/">四月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/01/">一月 2015<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material chenhongjie 

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>
  -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/Ricoccc" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/rico.austin.5" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://plus.google.com/u/0/103668464393164710629" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Rico's Blog
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->


    <script>lsloader.load("js/lazyload.min.js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==")</script>
    <script>lsloader.load("js/js.min.js","/js/js.min.js?oAl/+lvaqTFV31JXTmbrNA==")</script>



    <script>lsloader.load("js/nprogress.js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==")</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Window Load-->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Bing Background -->


<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.4.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
