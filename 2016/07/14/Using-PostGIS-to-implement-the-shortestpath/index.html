<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">







    <link rel="dns-prefetch" href="https://hm.baidu.com">



    <link rel="dns-prefetch" href="https://fonts.googleapis.com">





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            使用PostGIS实现最短路径服务 | 
        
        Rico&#39;s Blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="description" itemprop="description" content>
    <meta name="keywords" content="HogwartsRico,PostGIS">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?NKhlKQkXw/c66TR5p4wO+w==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/github-v2.min.css?AfzKxt++K+/lhZBlSjnxwg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body {
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Rico&#39;s Blog">
    <meta name="msapplication-starturl" content="http://hogwartsrico.github.io/2016/07/14/Using-PostGIS-to-implement-the-shortestpath/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Rico&#39;s Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://hogwartsrico.github.io/2016/07/14/Using-PostGIS-to-implement-the-shortestpath/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="使用PostGIS实现最短路径服务 | Rico&#39;s Blog">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content>
    <meta property="og:article:tag" content="PostGIS"> 

    
        <meta property="article:published_time" content="Thu Jul 14 2016 22:56:32 GMT+0800">
        <meta property="article:modified_time" content="Tue Mar 24 2020 11:19:16 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://hogwartsrico.github.io/2016/07/14/Using-PostGIS-to-implement-the-shortestpath/index.html">
    

    <!-- Structured-data for SEO -->
    

    <!-- Analytics -->
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?54ee66f82cedec3c2b6b4ea942911185';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#一、下载和安装"><span class="post-toc-number">1.</span> <span class="post-toc-text">一、下载和安装</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#导入shp数据"><span class="post-toc-number">2.</span> <span class="post-toc-text">导入shp数据</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#创建路网拓扑结构"><span class="post-toc-number">3.</span> <span class="post-toc-text">创建路网拓扑结构</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#尝试查询"><span class="post-toc-number">4.</span> <span class="post-toc-text">尝试查询</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#最短路径规划中创建基于geoserver的wms服务"><span class="post-toc-number">5.</span> <span class="post-toc-text">最短路径规划中创建基于geoserver的wms服务</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#参考文献"><span class="post-toc-number">6.</span> <span class="post-toc-text">参考文献</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 34 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                使用PostGIS实现最短路径服务
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Rico</strong>
        <span>7月 14, 2016</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/PostGIS/">PostGIS</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=使用PostGIS实现最短路径服务&url=http://hogwartsrico.github.io/2016/07/14/Using-PostGIS-to-implement-the-shortestpath/index.html&pic=http://hogwartsrico.github.io/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=使用PostGIS实现最短路径服务&url=http://hogwartsrico.github.io/2016/07/14/Using-PostGIS-to-implement-the-shortestpath/index.html&via=Rico" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://hogwartsrico.github.io/2016/07/14/Using-PostGIS-to-implement-the-shortestpath/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="一、下载和安装"><a href="#一、下载和安装" class="headerlink" title="一、下载和安装"></a>一、下载和安装</h1><p>PGRouting要配合PostgreSQL和Postgis使用，所以安装PGRouting之前要先安装PostgreSQL和Postgis，它们的官网地址分别是：<br>PostgreSQL          <a href="http://www.postgresql.org/" target="_blank" rel="noopener">http://www.postgresql.org/</a><br>Postgis                <a href="http://www.postgis.net/" target="_blank" rel="noopener">http://www.postgis.net/</a><br>PGRouting          <a href="http://pgrouting.org/" target="_blank" rel="noopener">http://pgrouting.org/</a>  github <a href="https://github.com/pgRouting/pgrouting" target="_blank" rel="noopener">https://github.com/pgRouting/pgrouting</a>  </p>
<p>另外在安装好PostgreSQL之后，程序本身会提供一个工具Application Stack Builder，我们也可以在这个工具中下载对应版本的Postgis。  </p>
<p>PostgreSQL和Postgis在windows下的安装相对简单，在这里说一下PGRouting的安装。  </p>
<p>在官网下载和本机PostgreSQL对应版本的PGRouting，我这里的版本的PostgreSQL 9.1，这个版本可以使用的PGRouting对应版本是2.0。</p>
<p>下面贴一下我的PosggreSQL和PostGIS 和pgRouting的版本</p>
<p>PostgreSQL下载地址  <a href="http://www.postgresql.org/download/" target="_blank" rel="noopener">http://www.postgresql.org/download/</a><br>PostGIS 下载地址 <a href="http://download.osgeo.org/postgis/windows/" target="_blank" rel="noopener">http://download.osgeo.org/postgis/windows/</a>  <a href="http://download.osgeo.org/postgis/windows/pg92/archive/" target="_blank" rel="noopener">http://download.osgeo.org/postgis/windows/pg92/archive/</a><br>pgRouting下载地址 <a href="http://pgrouting.org/download.html#windows-binaries" target="_blank" rel="noopener">http://pgrouting.org/download.html#windows-binaries</a>    <a href="http://postgis.net/windows_downloads" target="_blank" rel="noopener">http://postgis.net/windows_downloads</a>   <a href="http://winnie.postgis.net/download/windows/pg92/buildbot/" target="_blank" rel="noopener">http://winnie.postgis.net/download/windows/pg92/buildbot/</a>  <a href="http://winnie.postgis.net/download/windows/" target="_blank" rel="noopener">http://winnie.postgis.net/download/windows/</a></p>
<p>各版本兼容情况<br><a href="http://postgis.net/windows_downloads" target="_blank" rel="noopener">http://postgis.net/windows_downloads</a><br><a href="http://pgrouting.org/download.html" target="_blank" rel="noopener">http://pgrouting.org/download.html</a><br><img src="1.png" alt><br>下载PGRouing之后，可以看到里面有3个文件夹（bin、lib、share）和5个文件，以后可能会有变动，将这三个文件夹拷贝到PostgreSQL的安装目录下，和同名文件夹合并。<br><img src="2.png" alt></p>
<p>然后执行一遍share里面的sql,</p>
<p>具体方法:<br>点击这个sql查询按钮<br><img src="4.png" alt><br>弹出如下窗口,选择刚才几个的sql语句,都执行一遍<br><img src="5.png" alt><br>点击如下所示按钮执行sql语句<br><img src="6.png" alt></p>
<p>执行完这些后PostgreSQL就具备了最短路径分析的功能</p>
<h1 id="导入shp数据"><a href="#导入shp数据" class="headerlink" title="导入shp数据"></a>导入shp数据</h1><p>这个之前有写,需要注意四项:1新建数据库时选择PostGIS提供的模板,2编码选择GBK,3还有shp数据不要有中文路径<br>4把这个勾上<br><img src="3.png" alt><br>此处导入的shp数据一定要是单线的，否则无法完成路径计算。</p>
<h1 id="创建路网拓扑结构"><a href="#创建路网拓扑结构" class="headerlink" title="创建路网拓扑结构"></a>创建路网拓扑结构</h1><p><code>ALTER TABLE public.bjroad ADD COLUMN source integer;</code>//添加起点id</p>
<p><code>ALTER TABLE public.bjroad ADD COLUMN target integer;</code>//添加终点id</p>
<p><code>ALTER TABLE public.bjroad ADD COLUMN mlength double precision;</code>//添加道路 权重值 这里长度就是权重了 </p>
<p>这里先介绍一个Pgrouting的函数：pgr_createTopology，这个函数就是将我们的路网（线型）数据形成拓扑导航网络的数据，为下一步的导航路径算法提供支持<br><code>SELECT pgr_createTopology(&#39;public.bjroad&#39;,0.00001, &#39;geom&#39;, &#39;gid&#39;);</code>//创建拓扑布局，即为source和target字段赋值<br>详见 <a href="http://docs.pgrouting.org/2.0/en/src/common/doc/functions/create_topology.html#pgr-create-topology" target="_blank" rel="noopener">http://docs.pgrouting.org/2.0/en/src/common/doc/functions/create_topology.html#pgr-create-topology</a></p>
<p><img src="7.png" alt><br><img src="8.png" alt><br><img src="9.png" alt> </p>
<p>为source和target字段创建索引<br><code>CREATE INDEX source_idx ON bjroad(&quot;source&quot;);</code><br><code>CREATE INDEX target_idx ON bjroad(&quot;target&quot;);</code>  </p>
<p>为mlength赋值<br><code>update bjroad set mlength =st_length(geom);</code></p>
<p>为bjroad表添加reverse_cost字段并用mlength的值赋值</p>
<p><code>ALTER TABLE bjroad ADD COLUMN reverse_cost double precision;</code><br><code>UPDATE bjroad SET reverse_cost = length;</code></p>
<h1 id="尝试查询"><a href="#尝试查询" class="headerlink" title="尝试查询"></a>尝试查询</h1><p> 查询从30号点到60号点的最短路径</p>
<pre><code class="SQL">SELECT seq, id1 AS node, id2 AS edge, cost FROM pgr_dijkstra(&#39;

SELECT gid AS id,                   

source::integer,                       

target::integer,                      

length::double precision AS cost

FROM bjroad&#39;,

30, 60, false, false);
</code></pre>
<p><img src="10.png" alt></p>
<p>//查询每个路段经过的点</p>
<pre><code class="SQL">SELECT st_astext(geom) FROM pgr_dijkstra(&#39;

SELECT gid AS id,                   

source::integer,                       

target::integer,                      

length::double precision AS cost

FROM bjroad&#39;,

30, 60, false, false) as di

join bjroad pt

on di.id2 = pt.gid;
</code></pre>
<p><img src="11.png" alt></p>
<p>//把查询结果放在新建的表格中dijkstra_res就是新建的表</p>
<pre><code class="SQL">SELECT seq, id1 AS node, id2 AS edge, cost,geom into dijkstra_res FROM pgr_dijkstra(&#39;

SELECT gid AS id,                    

source::integer,                       

target::integer,                      

length::double precision AS cost

FROM bjroad&#39;,

30, 60, false, false) as di

join bjroad pt

on di.id2 = pt.gid;
</code></pre>
<p><img src="12.png" alt><br><img src="13.png" alt>  </p>
<pre><code class="SQL">
pgr_dijkstra的定义是pgr_costResult[]
pgr_dijkstra(textsql, integer source, integer target, boolean directed, boolean has_rcost);

directed是否限制方向，has_ rcost作用未知，返回值为pgr_costResult。

pgr_costResult在workshop中的解释是

A set of records to describe a path resultwith cost attribute

一组带有消耗属性的用于描述路径结果的记录的集合。

其定义如下

CREATE TYPE pgr_costResult AS

(

    seq integer, -- rowsequence

    id1 integer, -- node ID

    id2 integer, -- edge ID(-1 for the last row)

    cost float8 -- cost totraverse from id1 using id2

);

`
</code></pre>
<p>将这个表导出为shp，再在arcmap中定义坐标系打开，可以看到上面的结果如下图所示<br><img src="14.png" alt></p>
<hr>
<p>前面介绍了如何利用postgresql创建空间数据库，建立空间索引和进行路径规划。但是在真实的场景中用户进行路径规划的时候都是基于经纬度数据进行路径规划的，因为用户根本不会知道道路上节点的ID。因此接下来讲述如何查询任意两点间的最短路径。  </p>
<p>一、定义函数名及函数参数</p>
<p>函数名定义为： <code>pgr_fromAtoB</code></p>
<p>参数设置分别为：<br>输入为数据库表名，起点和终点的经纬度坐标<br>输出为：路段序号，gid号，道路名，消耗及道路集合体。</p>
<pre><code class="SQL">IN tbl varchar, --数据库表名
IN x1 double precision, --起点x坐标
IN y1 double precision, --起点y坐标
IN x2 double precision, --终点x坐标
IN y2 double precision, --终点y坐标
OUT seq integer,
OUT gid integer,
OUT name text,
OUT heading double precision,
OUT cost double precision,
OUT geom geometry
</code></pre>
<p>二、计算距离起点和终点距离最近的道路节点，</p>
<p>可以使用的函数为</p>
<pre><code class="SQL">SELECT id::integer FROM minidata_vertices_pgr 
ORDER BY the_geom &lt;-&gt; ST_GeometryFromText(&#39;&#39;POINT(&#39; 
|| x1 || &#39; &#39; || y1 || &#39;)&#39;&#39;,4326) LIMIT 1
</code></pre>
<p> 三、然后根据检索到的节点再调用pgrouting的最短路径查询函数进行计算。<br>可以使用的函数为：</p>
<pre><code class="SQL"> SELECT gid, geom, name, cost, source, target, 
                ST_Reverse(geom) AS flip_geom FROM &#39; ||
                        &#39;pgr_bdAstar(&#39;&#39;SELECT gid as id, source::int, target::int, &#39;
                                        || &#39;length::float AS cost,x1,y1,x2,y2 FROM &#39;
                                        || quote_ident(tbl) || &#39;&#39;&#39;, &#39;
                                        || source || &#39;, &#39; || target 
                                        || &#39; ,false, false), &#39;
                                || quote_ident(tbl) || &#39; WHERE id2 = gid ORDER BY seq
</code></pre>
<p>  四、整合上面几个子过程，得到的最终查询sql函数如下：</p>
<pre><code>--
--DROP FUNCTION pgr_fromAtoB(varchar, double precision, double precision, 
--                           double precision, double precision);

CREATE OR REPLACE FUNCTION pgr_fromAtoB(
                IN tbl varchar,
                IN x1 double precision,
                IN y1 double precision,
                IN x2 double precision,
                IN y2 double precision,
                OUT seq integer,
                OUT gid integer,
                OUT name text,
                OUT heading double precision,
                OUT cost double precision,
                OUT geom geometry
        )
        RETURNS SETOF record AS
$BODY$
DECLARE
        sql     text;
        rec     record;
        source    integer;
        target    integer;
        point    integer;

BEGIN
    -- 查询距离出发点最近的道路节点
    EXECUTE &#39;SELECT id::integer FROM minidata_vertices_pgr 
            ORDER BY the_geom &lt;-&gt; ST_GeometryFromText(&#39;&#39;POINT(&#39; 
            || x1 || &#39; &#39; || y1 || &#39;)&#39;&#39;,900913) LIMIT 1&#39; INTO rec;
    source := rec.id;

    -- 查询距离目的地最近的道路节点
    EXECUTE &#39;SELECT id::integer FROM minidata_vertices_pgr 
            ORDER BY the_geom &lt;-&gt; ST_GeometryFromText(&#39;&#39;POINT(&#39; 
            || x2 || &#39; &#39; || y2 || &#39;)&#39;&#39;,900913) LIMIT 1&#39; INTO rec;
    target := rec.id;

    -- 最短路径查询 
        seq := 0;
        sql := &#39;SELECT gid, geom, name, cost, source, target, 
                ST_Reverse(geom) AS flip_geom FROM &#39; ||
                        &#39;pgr_bdAstar(&#39;&#39;SELECT gid as id, source::int, target::int, &#39;
                                        || &#39;length::float AS cost,x1,y1,x2,y2 FROM &#39;
                                        || quote_ident(tbl) || &#39;&#39;&#39;, &#39;
                                        || source || &#39;, &#39; || target 
                                        || &#39; ,false, false), &#39;
                                || quote_ident(tbl) || &#39; WHERE id2 = gid ORDER BY seq&#39;;


    -- Remember start point
        point := source;

        FOR rec IN EXECUTE sql
        LOOP
        -- Flip geometry (if required)
        IF ( point != rec.source ) THEN
            rec.geom := rec.flip_geom;
            point := rec.source;
        ELSE
            point := rec.target;
        END IF;

        -- Calculate heading (simplified)
        EXECUTE &#39;SELECT degrees( ST_Azimuth( 
                ST_StartPoint(&#39;&#39;&#39; || rec.geom::text || &#39;&#39;&#39;),
                ST_EndPoint(&#39;&#39;&#39; || rec.geom::text || &#39;&#39;&#39;) ) )&#39; 
            INTO heading;

        -- Return record
                seq     := seq + 1;
                gid     := rec.gid;
                name    := rec.name;
                cost    := rec.cost;
                geom    := rec.geom;
                RETURN NEXT;
        END LOOP;
        RETURN;
END;
$BODY$
LANGUAGE &#39;plpgsql&#39; VOLATILE STRICT;
</code></pre><p>但是上面查询任意两点间最短路径的函数，是由于当时对pgrouting不熟悉，功能很low。现在对该函数进行扩展，支持用户自己输入查询的数据库表，这一点看似简单，其实意义很大，在做室内导航的时候当用户所在的楼层变化的时候最短路径函数查询的数据表名称也会发生变化，不可能一栋大楼里的道路都是一样的吧，另外进行跨楼层的最短路径规划时，需要查询从A到楼梯口的最短路径和楼梯口到B的最短路径，这些都需要进行最短路径规划的时候能够自己选择数据表。</p>
<p>先解释一下最短路径规划的处理步骤，首先要确定用户的出发点和目的地所在的道路，再在相应的道路上确定道路的节点，查找这两个节点之间的最短路径，最后再处理出发点和目的地到道路节点之间的路段。具体过程为：</p>
<ol>
<li><p>查找距离用户出发点最近的道路和该道路的终点T。</p>
</li>
<li><p>查找距离用户目的地最近的道路和该道路的起点S。</p>
</li>
<li><p>计算前两步找出的两点之间的最短路径。</p>
</li>
<li><p>处理出发点和道路终点T以及目的去和道路起点S之间的路段。</p>
</li>
</ol>
<pre><code class="SQL">DROP FUNCTION pgr_fromAtoB(tbl varchar,startx float, starty float,endx float,endy float);
CREATE OR REPLACE function pgr_fromAtoB(tbl varchar,startx float, starty float,endx float,endy float)   
returns  geometry as  
$body$  
declare  
    v_startLine geometry;--离起点最近的线  
    v_endLine geometry;--离终点最近的线  

    v_startTarget integer;--距离起点最近线的终点  
    v_endSource integer;--距离终点最近线的起点  

    v_statpoint geometry;--在v_startLine上距离起点最近的点  
    v_endpoint geometry;--在v_endLine上距离终点最近的点  

    v_res geometry;--最短路径分析结果  


    v_perStart float;--v_statpoint在v_res上的百分比  
    v_perEnd float;--v_endpoint在v_res上的百分比  

    v_shPath geometry;--最终结果
    tempnode float;    
begin     

    --查询离起点最近的线  
    execute &#39;select geom ,target  from &#39; ||tbl||
            &#39; where 
            ST_DWithin(geom,ST_Geometryfromtext(&#39;&#39;point(&#39;||    startx ||&#39; &#39; || starty||&#39;)&#39;&#39;),15) 
            order by ST_Distance(geom,ST_GeometryFromText(&#39;&#39;point(&#39;|| startx ||&#39; &#39;|| starty ||&#39;)&#39;&#39;))  limit 1&#39; 
            into v_startLine ,v_startTarget;  

    --查询离终点最近的线  
    execute &#39;select geom,source  from &#39; ||tbl||
            &#39; where ST_DWithin(geom,ST_Geometryfromtext(&#39;&#39;point(&#39;|| endx || &#39; &#39; || endy ||&#39;)&#39;&#39;),15) 
            order by ST_Distance(geom,ST_GeometryFromText(&#39;&#39;point(&#39;|| endx ||&#39; &#39; || endy ||&#39;)&#39;&#39;))  limit 1&#39; 
            into v_endLine,v_endSource;  

    --如果没找到最近的线，就返回null  
    if (v_startLine is null) or (v_endLine is null) then  
        return null;  
    end if ;  

    select  ST_ClosestPoint(v_startLine, ST_Geometryfromtext(&#39;point(&#39;|| startx ||&#39; &#39; || starty ||&#39;)&#39;)) into v_statpoint;  
    select  ST_ClosestPoint(v_endLine, ST_GeometryFromText(&#39;point(&#39;|| endx ||&#39; &#39; || endy ||&#39;)&#39;)) into v_endpoint;  


    --最短路径  
    execute &#39;SELECT st_linemerge(st_union(b.geom)) &#39; || 
    &#39;FROM pgr_kdijkstraPath(  
    &#39;&#39;SELECT gid as id, source, target, mlength as cost FROM &#39; || tbl ||&#39;&#39;&#39;,&#39;  
    ||v_startTarget || &#39;, &#39; ||&#39;array[&#39;||v_endSource||&#39;] , false, false  
    ) a, &#39;  
    || tbl || &#39; b  
    WHERE a.id3=b.gid  
    GROUP by id1  
    ORDER by id1&#39; into v_res;  

    --如果找不到最短路径，就返回null  
    if(v_res is null) then  
        return null;  
    end if;  

    --将v_res,v_startLine,v_endLine进行拼接  
    select  st_linemerge(ST_Union(array[v_res,v_startLine,v_endLine])) into v_res;  

    select  ST_Line_Locate_Point(v_res, v_statpoint) into v_perStart;  
    select  ST_Line_Locate_Point(v_res, v_endpoint) into v_perEnd;  

    if(v_perStart &gt; v_perEnd) then  
        tempnode =  v_perStart;
        v_perStart = v_perEnd;
        v_perEnd = tempnode;
    end if;

    --截取v_res  
    SELECT ST_Line_SubString(v_res,v_perStart, v_perEnd) into v_shPath;  

    return v_shPath;  



end;  
$body$  
LANGUAGE plpgsql VOLATILE STRICT
</code></pre>
<p>使用这个最短路径规划函数进行路径规划一般不会出现问题，但是有的时候会出现这样的问题，因为函数的查找思路是查找距离起点最近的线和改线的终点，查找离目的地最近的线和该线的起点，这样有可能会出现这样的情况，就是起点和终点对应的线段是相连接的，这时查找的距离起点最近线的终点和距离目的地最近线上的起点就是同一个点，这样的话这两点直接就没有最短距离。</p>
<p>所以需要对上述代码第59到61行进行修改，修改后的代码如下  </p>
<p><strong>最终使用的函数</strong></p>
<pre><code class="SQL">DROP FUNCTION pgr_fromAtoB(tbl varchar,startx float, starty float,endx float,endy float);
CREATE OR REPLACE function pgr_fromAtoB(tbl varchar,startx float, starty float,endx float,endy float)   
returns  geometry as  
$body$  
declare  
    v_startLine geometry;--离起点最近的线  
    v_endLine geometry;--离终点最近的线  

    v_startTarget integer;--距离起点最近线的终点  
    v_endSource integer;--距离终点最近线的起点  

    v_statpoint geometry;--在v_startLine上距离起点最近的点  
    v_endpoint geometry;--在v_endLine上距离终点最近的点  

    v_res geometry;--最短路径分析结果  


    v_perStart float;--v_statpoint在v_res上的百分比  
    v_perEnd float;--v_endpoint在v_res上的百分比  

    v_shPath geometry;--最终结果
    tempnode float;    
begin     

    --查询离起点最近的线  
    execute &#39;select geom ,target  from &#39; ||tbl||
            &#39; where 
            ST_DWithin(geom,ST_Geometryfromtext(&#39;&#39;point(&#39;||    startx ||&#39; &#39; || starty||&#39;)&#39;&#39;),15) 
            order by ST_Distance(geom,ST_GeometryFromText(&#39;&#39;point(&#39;|| startx ||&#39; &#39;|| starty ||&#39;)&#39;&#39;))  limit 1&#39; 
            into v_startLine ,v_startTarget;  

    --查询离终点最近的线  
    execute &#39;select geom,source  from &#39; ||tbl||
            &#39; where ST_DWithin(geom,ST_Geometryfromtext(&#39;&#39;point(&#39;|| endx || &#39; &#39; || endy ||&#39;)&#39;&#39;),15) 
            order by ST_Distance(geom,ST_GeometryFromText(&#39;&#39;point(&#39;|| endx ||&#39; &#39; || endy ||&#39;)&#39;&#39;))  limit 1&#39; 
            into v_endLine,v_endSource;  

    --如果没找到最近的线，就返回null  
    if (v_startLine is null) or (v_endLine is null) then  
        return null;  
    end if ;  

    select  ST_ClosestPoint(v_startLine, ST_Geometryfromtext(&#39;point(&#39;|| startx ||&#39; &#39; || starty ||&#39;)&#39;)) into v_statpoint;  
    select  ST_ClosestPoint(v_endLine, ST_GeometryFromText(&#39;point(&#39;|| endx ||&#39; &#39; || endy ||&#39;)&#39;)) into v_endpoint;  


    --最短路径  
    execute &#39;SELECT st_linemerge(st_union(b.geom)) &#39; || 
    &#39;FROM pgr_kdijkstraPath(  
    &#39;&#39;SELECT gid as id, source, target, mlength as cost FROM &#39; || tbl ||&#39;&#39;&#39;,&#39;  
    ||v_startTarget || &#39;, &#39; ||&#39;array[&#39;||v_endSource||&#39;] , false, false  
    ) a, &#39;  
    || tbl || &#39; b  
    WHERE a.id3=b.gid  
    GROUP by id1  
    ORDER by id1&#39; into v_res ;  

    --如果找不到最短路径，就返回null  
    --if(v_res is null) then  
    --    return null;  
    --end if;  

    --将v_res,v_startLine,v_endLine进行拼接  
    select  st_linemerge(ST_Union(array[v_res,v_startLine,v_endLine])) into v_res;  

    select  ST_Line_Locate_Point(v_res, v_statpoint) into v_perStart;  
    select  ST_Line_Locate_Point(v_res, v_endpoint) into v_perEnd;  

    if(v_perStart &gt; v_perEnd) then  
        tempnode =  v_perStart;
        v_perStart = v_perEnd;
        v_perEnd = tempnode;
    end if;

    --截取v_res  
    SELECT ST_Line_SubString(v_res,v_perStart, v_perEnd) into v_shPath;  

    return v_shPath;  



end;  
$body$  
LANGUAGE plpgsql VOLATILE STRICT
</code></pre>
<p>将这个函数在PostgreSQL的sql查询工具中执行一遍就可以了  </p>
<p>这时你在sql查询中输入<br><code>SELECT * FROM pgr_fromatob(&#39;bjroad&#39;, x1, y1, x2, y2  )</code><br>或<br><code>SELECT pgr_fromatob.geometry FROM pgr_fromatob(&#39;bjroad&#39;, x1, y1, x2, y2  )</code>就可以查询到从点1到点2的路径了</p>
<h1 id="最短路径规划中创建基于geoserver的wms服务"><a href="#最短路径规划中创建基于geoserver的wms服务" class="headerlink" title="最短路径规划中创建基于geoserver的wms服务"></a>最短路径规划中创建基于geoserver的wms服务</h1><p>上面文章写了求任意两点间最短路径的sql函数，接下来讲一下如何把上面介绍的子功能整合到系统中去</p>
<p>单击左侧数据存储图标，会进入新建数据源页面<br><img src="15.png" alt><br>单击postgis，会弹出数据库的访问设置对话框<br>在对话框中选择工作区，填入数据源名称、数据库名以及用户名密码 点击保存</p>
<p>在弹出的新页面中单击配置新的SQL视图，<br><img src="16.png" alt> </p>
<p>在出现的新页面中输入视图名称以及最短路径规划的查询sql语句（pgr_fromAtoB为自定义的查询函数，需要添加到postgresql中,上文已经将其添加进去了）</p>
<p>在出现的新页面中输入视图名称以及最短路径规划的查询sql语句（pgr_fromAtoB为自定义的查询函数，需要添加到postgresql中），</p>
<pre><code class="SQL">SELECT ST_MakeLine(route.geometry) FROM (

   SELECT pgr_fromatob.geometry FROM pgr_fromatob(&#39;bjroad&#39;, %x1%, %y1%, %x2%, %y2%  )

) AS route
</code></pre>
<p>单击从sql猜想的参数，把x1 y1 x2 y2的默认值都设为0，正则表达式中全部输入<code>^-?[\d.]+$</code> 。最后点刷新按钮，在出现的st_makeline结果数据中选择其类型为linestring，坐标系为4326<br><img src="17.png" alt></p>
<p><img src="18.png" alt></p>
<p>然后就像普通图层那样将其发布即可<br><img src="19.png" alt><br><img src="20.png" alt></p>
<p>然后写代码就可以实现最短路径功能了  </p>
<pre><code class="HTML">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&gt;&quot;
&lt;head&gt;
    &lt;title&gt;最短路径分析&lt;/title&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=UTF-8&quot;&gt;
    &lt;style type=&quot;text/css&quot;&gt; v\:* {behavior:url(#default#VML);}
        html, body { overflow: hidden; padding: 0; height: 100%; width: 100%; font-family: &#39;Lucida Grande&#39;,Geneva,Arial,Verdana,sans-serif; }
        body { margin: 0px; background: #fff; }
        #map { height: 100%; border: 1px solid #888; }
        .olImageLoadError {
            display: none !important;
        }
        ul li{height:28px; width:100%;list-style:none;}
 li a{
    padding-left:0px; 
    width:100%; 
    line-height:0px;
    text-decoration:none;
    color:#666;
}
    &lt;/style&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://xxxxx/OpenLayers-2.11/theme/default/style.css&quot; type=&quot;text/css&quot;&gt;
    &lt;script src=&quot;http://xxxxx/OpenLayers-2.11/OpenLayers.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
        var tilerpath=&quot;http://xxxxxx/zjTDT/&quot;;//你的底图地址
        var map,baselayer,tmsoverlay,bjroadLayer,markerLayer;
        OpenLayers.Util.onImageLoadErrorColor = &quot;transparent&quot;;
        function init(){
            var options = {
                controls: [new OpenLayers.Control.PanZoomBar(),
                new OpenLayers.Control.Navigation({dragPanOptions:{enableKinetic:true}}),new OpenLayers.Control.MousePosition()],
                projection: new OpenLayers.Projection(&quot;EPSG:4326&quot;),
                resolutions:[0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.000021457672119140625,0.0000107288360595703125,0.00000536441802978515625],
                maxExtent: new OpenLayers.Bounds(-180, -90, 180, 90)
            };
            map = new OpenLayers.Map(&#39;map&#39;, options);

            baselayer = new OpenLayers.Layer.TMS( &quot;天地图底图&quot;, tilerpath+&quot;TDTVec&quot;,
            { 
                serviceVersion: &#39;.&#39;, layername: &#39;.&#39;, alpha: true,
                type: &#39;png&#39;, getURL: overlay_getTileURL,
                isBaseLayer: true
            });

            tmsoverlay = new OpenLayers.Layer.TMS( &quot;天地图标注&quot;, tilerpath+&quot;TDTVecAnno&quot;,
            {
                serviceVersion: &#39;.&#39;, layername: &#39;.&#39;, alpha: true,
                type: &#39;png&#39;, getURL: overlay_getTileURL,
                isBaseLayer: false
            });
             function overlay_getTileURL(bounds) {
                bounds = this.adjustBounds(bounds);
                var res = this.map.getResolution();
                var x = Math.round((bounds.left - this.tileOrigin.lon) / (res * this.tileSize.w));
                var y = Math.round(Math.abs((bounds.bottom + this.tileOrigin.lat))/(res * this.tileSize.h))-1;
                var z = this.map.getZoom()+2;
            return this.url + &quot;/L&quot;+z+&quot;/&quot;+x+&quot;/&quot;+y+&quot;.png&quot;;//&amp;x=&quot;+x+&quot;&amp;y=&quot;+y+&quot;&amp;l=&quot;+z;
            }    

            map.addLayers([baselayer,tmsoverlay]);
             map.setCenter(new OpenLayers.LonLat(120.00,30.25),10);

            //-----------------------------------------
             bjroadLayer = new OpenLayers.Layer.WMS(&quot;OpenLayers WMS&quot;,   
                &#39;http://xxxxx:8080/geoserver/chj/wms&#39;,     
                {    
                    layers: &#39;chj:bjroadshp&#39;  ,format:&#39;image/png&#39;,transparent:true  
                });    
            map.addLayer(bjroadLayer);

            markerLayer = new OpenLayers.Layer.Markers(&quot;markers&quot;);         
            icon = new OpenLayers.Icon(&#39;marker.png&#39;,new OpenLayers.Size(21,25));
            map.addLayer(markerLayer);  



            //清空路径规划结果  
            var clearButton = document.getElementById(&#39;clear&#39;);  
            clearButton.addEventListener(&#39;click&#39;, function(event) {  
                // Reset the &quot;start&quot; and &quot;destination&quot; features.  
                startPointSet = false;  
                endPointSet = false;  
                // Remove the result layer.  
                markerLayer.removeMarker(startPoint);  
                markerLayer.removeMarker(destPoint);  
                startPoint.destroy();  
                destPoint.destroy();  
                map.removeLayer(result);  
            });           
        map.events.register(&#39;click&#39;, map, onMapClick);      

}// init end


var startPointSet = false;
var endPointSet = false;
var startCoord;
var destCoord

var result;
var result2;
function onMapClick(event)
{

     // 显示地图屏幕坐标
    if (!startPointSet) {    
    var lonlat = map.getLonLatFromPixel(event.xy);
    startPoint = new OpenLayers.Marker(lonlat);  
    markerLayer.addMarker(startPoint);
    startCoord = new OpenLayers.Geometry.Point(lonlat.lon,lonlat.lat);
    startPointSet = true;
  } 
  else if (!endPointSet) {
    // Second click.
    var lonlat = map.getLonLatFromPixel(event.xy);
    destPoint = new OpenLayers.Marker(lonlat);  
    markerLayer.addMarker(destPoint);
    destCoord = new OpenLayers.Geometry.Point(lonlat.lon,lonlat.lat);
    endPointSet = true;
    // Transform the coordinates from the map projection (EPSG:3857)
    // to the server projection (EPSG:4326).

    var viewparams = [
      &#39;x1:&#39; + startCoord.x, &#39;y1:&#39; + startCoord.y,
      &#39;x2:&#39; + destCoord.x, &#39;y2:&#39; + destCoord.y
      // &#39;x1:&#39; + 12952117.2529, &#39;y1:&#39; + 4836395.5717,
     // &#39;x2:&#39; + 12945377.2585, &#39;y2:&#39; + 4827305.7549
    ];
    viewparams = viewparams.join(&#39;;&#39;);
    result = new OpenLayers.Layer.WMS(&quot;resLayer&quot;,
    &#39;http://xxxxx:8080/geoserver/rico/wms&#39;,
    {    FORMAT: &#39;image/png8&#39;,
        transparent: true,
        LAYERS: &#39;chj:pgrfromAtoB&#39;,
        viewparams:viewparams
    },
    {isBaseLayer:false,
    opacity: 1,
    }        
    );

    map.addLayer(result);



  }// else if end 
 }// onMapClick end



    &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init()&quot;&gt;
&lt;div style=&quot;float:left;width:20%;height:100%;&quot;&gt; 
        &lt;ul style=&quot;margin-top:100px;&quot;&gt;

            &lt;li&gt;&lt;a href=&quot;javascript:void(0);&quot; id=&quot;clear&quot;&gt;清空&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
    &lt;/div&gt;
        &lt;div style=&quot;float:left;width:80%;height:100%;&quot;&gt; 
    &lt;div id=&#39;map&#39; style=&#39;width: 100%; height:100%;&#39;&gt;&lt;/div&gt;
    &lt;/div&gt;    
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><img src="21.png" alt> </p>
<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p><a href="http://blog.csdn.net/longshengguoji/article/details/45565551" target="_blank" rel="noopener">http://blog.csdn.net/longshengguoji/article/details/45565551</a><br><a href="http://blog.csdn.net/cehui115081/article/details/19808889" target="_blank" rel="noopener">http://blog.csdn.net/cehui115081/article/details/19808889</a><br><a href="http://blog.csdn.net/longshengguoji/article/details/46051111" target="_blank" rel="noopener">http://blog.csdn.net/longshengguoji/article/details/46051111</a><br><a href="http://www.davidgis.fr/documentation/pgrouting-1.02/" target="_blank" rel="noopener">http://www.davidgis.fr/documentation/pgrouting-1.02/</a><br><a href="http://blog.csdn.net/longshengguoji/article/details/46350355" target="_blank" rel="noopener">http://blog.csdn.net/longshengguoji/article/details/46350355</a><br><a href="http://blog.csdn.net/longshengguoji/article/details/46350675" target="_blank" rel="noopener">http://blog.csdn.net/longshengguoji/article/details/46350675</a><br><a href="http://www.openlayers.cn/forum.php?mod=viewthread&amp;tid=14&amp;page=1" target="_blank" rel="noopener">http://www.openlayers.cn/forum.php?mod=viewthread&amp;tid=14&amp;page=1</a><br><a href="http://blog.csdn.net/longshengguoji/article/details/45602219" target="_blank" rel="noopener">http://blog.csdn.net/longshengguoji/article/details/45602219</a><br><a href="http://blog.csdn.net/longshengguoji?viewmode=contents" target="_blank" rel="noopener">http://blog.csdn.net/longshengguoji?viewmode=contents</a><br><a href="http://blog.csdn.net/longshengguoji/article/details/46793111" target="_blank" rel="noopener">http://blog.csdn.net/longshengguoji/article/details/46793111</a><br><a href="http://blog.csdn.net/longshengguoji/article/details/45602219" target="_blank" rel="noopener">http://blog.csdn.net/longshengguoji/article/details/45602219</a><br><a href="http://blog.csdn.net/yifei1989/article/details/14137891" target="_blank" rel="noopener">http://blog.csdn.net/yifei1989/article/details/14137891</a><br><a href="http://blog.csdn.net/yifei1989/article/details/9500187#comments" target="_blank" rel="noopener">http://blog.csdn.net/yifei1989/article/details/9500187#comments</a><br><a href="http://blog.csdn.net/yifei1989/article/details/14004661" target="_blank" rel="noopener">http://blog.csdn.net/yifei1989/article/details/14004661</a><br><a href="http://blog.csdn.net/yifei1989/article/details/14137891" target="_blank" rel="noopener">http://blog.csdn.net/yifei1989/article/details/14137891</a></p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            This blog is under a CC BY-NC-SA 3.0 Unported License
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="http://hogwartsrico.github.io/2016/07/14/Using-PostGIS-to-implement-the-shortestpath/">http://hogwartsrico.github.io/2016/07/14/Using-PostGIS-to-implement-the-shortestpath/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2016/09/12/Compile-And-Install-PostgreSQL-PostGIS/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/03/11/AStarPathFinding/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Rico's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        chenhongjie101@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:chenhongjie101@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/08/">八月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">10</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/10/">十月 2019<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/05/">五月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/03/">三月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/02/">二月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/01/">一月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/04/">四月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/01/">一月 2015<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">43</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/Ricoccc" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/rico.austin.5" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://plus.google.com/u/0/103668464393164710629" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    
        <a href="https://weibo.com/1878017080/profile" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    
        <a href="https://www.instagram.com/hogwartsrico/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-instagram">
                <span class="visuallyhidden">Instagram</span>
            </button><!--
     --></a>
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/HogwartsRico" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    
        <a href="https://space.bilibili.com/14573494" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-bilibili">
                <span class="visuallyhidden">Bilibili</span>
            </button><!--
     --></a>
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    
        <a href="https://v2ex.com/member/Rico" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-v2ex">
                <span class="visuallyhidden">V2EX</span>
            </button><!--
     --></a>
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;Rico's Blog
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>-->
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?Bn9UzEm8RrBSxqyZB0zPjA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("sm_js","/js/smoothscroll.js?lOy/ACj5suSNi7ZVFVbpFQ==", true)</script>
    











<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->

<script type="text/ls-javascript" id="Bing-Background-script">
    queue.offer(function(){
        $('body').attr('data-original', 'https://api.i-meto.com/bing?');
    });
</script>


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2014;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
