<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-KR9KQDPLNN"></script>
	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?9f6e840b58b5e4559139f46db920717d";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>

	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-KR9KQDPLNN');
	</script>
    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">







    <link rel="dns-prefetch" href="https://hm.baidu.com"/>



    <link rel="dns-prefetch" href="https://fonts.googleapis.com"/>





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            使用Lucene索引存储空间数据 | 
        
        Rico&#39;s Blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="HogwartsRico,Lucene">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?uVzgA6RLrOm13Ukw8Qgy+A==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/github-v2.min.css?AfzKxt++K+/lhZBlSjnxwg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body {
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?ezyEvm8ST5CGfpA+kFFi1g==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Rico&#39;s Blog">
    <meta name="msapplication-starturl" content="http://hogwartsrico.github.io/2017/03/20/Index-SpatialData/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Rico&#39;s Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://hogwartsrico.github.io/2017/03/20/Index-SpatialData/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="使用Lucene索引存储空间数据 | Rico&#39;s Blog">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="Lucene"> 

    
        <meta property="article:published_time" content="Mon Mar 20 2017 21:49:22 GMT+0800">
        <meta property="article:modified_time" content="Sun Dec 19 2021 18:34:24 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://hogwartsrico.github.io/2017/03/20/Index-SpatialData/index.html" />
    

    <!-- Structured-data for SEO -->
    

    <!-- Analytics -->
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?54ee66f82cedec3c2b6b4ea942911185';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

<meta name="generator" content="Hexo 6.3.0"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E4%B8%BA%E4%BD%95%E8%A6%81%E5%AF%B9%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E7%B4%A2%E5%BC%95"><span class="post-toc-number">1.</span> <span class="post-toc-text">为何要对地理数据进行索引</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%97%AE%E9%A2%98"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">问题</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BC%A0%E7%BB%9F%E7%9A%84%E8%A7%A3%E5%86%B3%E6%80%9D%E8%B7%AF"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">传统的解决思路</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A-%E6%9A%B4%E5%8A%9B%E6%96%B9%E6%B3%95"><span class="post-toc-number">1.1.1.1.</span> <span class="post-toc-text">方法一： 暴力方法</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C-%E7%9F%A9%E5%BD%A2%E8%BF%87%E6%BB%A4%E6%B3%95"><span class="post-toc-number">1.1.1.2.</span> <span class="post-toc-text">方法二:矩形过滤法</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%A9%BA%E9%97%B4%E7%B4%A2%E5%BC%95%E6%80%9D%E8%B7%AF"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">空间索引思路</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%A6%82%E4%BD%95%E5%AF%B9%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95"><span class="post-toc-number">2.</span> <span class="post-toc-text">如何对地理数据建立索引</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#shpfile%E4%BB%8B%E7%BB%8D"><span class="post-toc-number">3.</span> <span class="post-toc-text">shpfile介绍</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#shp%E5%AD%98%E5%85%A5Lucene"><span class="post-toc-number">4.</span> <span class="post-toc-text">shp存入Lucene</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%BC%95%E5%85%A5%E7%AC%AC%E4%B8%89%E6%96%B9%E5%8C%85"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">引入第三方包</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Java%E8%AF%BB%E5%8F%96ShapeFile%E6%96%87%E4%BB%B6"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">Java读取ShapeFile文件</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Java%E8%AF%BB%E5%8F%96shp%E5%86%85%E5%AE%B9"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">Java读取shp内容</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%98%E5%85%A5lucene"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">存入lucene</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="post-toc-number">5.</span> <span class="post-toc-text">参考资料</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 28 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                使用Lucene索引存储空间数据
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Rico</strong>
        <span>3月 20, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-none-link" href="/tags/Lucene/" rel="tag">Lucene</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=使用Lucene索引存储空间数据&url=http://hogwartsrico.github.io/2017/03/20/Index-SpatialData/index.html&pic=http://hogwartsrico.github.io/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=使用Lucene索引存储空间数据&url=http://hogwartsrico.github.io/2017/03/20/Index-SpatialData/index.html&via=Rico" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://hogwartsrico.github.io/2017/03/20/Index-SpatialData/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="为何要对地理数据进行索引"><a href="#为何要对地理数据进行索引" class="headerlink" title="为何要对地理数据进行索引"></a>为何要对地理数据进行索引</h1><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>先思考个常见的问题：如何根据自己所在位置查询来查询附近1公里的POI(比如商家、ATM、景点等)</p>
<p><img src="21.png" alt></p>
<h3 id="传统的解决思路"><a href="#传统的解决思路" class="headerlink" title="传统的解决思路"></a>传统的解决思路</h3><h4 id="方法一：-暴力方法"><a href="#方法一：-暴力方法" class="headerlink" title="方法一： 暴力方法"></a>方法一： 暴力方法</h4><p>该方法的思路很直接：计算位置与所有POI的距离(全世界,全中国,全杭州的POI?那数据量可不是一般的大呀)，并保留距离小于1000米的POI。</p>
<p>插句题外话，计算经纬度之间的距离不能像求欧式距离那样平方开根号，因为地球是个不规整的球体（图2a），按最简单的完美球体假设，两点之间的距离函数应该如图2b所示。</p>
<p><img src="22.png" alt></p>
<p>该方法的复杂度为：POI数量*距离函数</p>
<h4 id="方法二-矩形过滤法"><a href="#方法二-矩形过滤法" class="headerlink" title="方法二:矩形过滤法"></a>方法二:矩形过滤法</h4><p>该方法分为两步：</p>
<p>a)先用矩形框过滤,排除大部分的点位（图4a），判断一个点在矩形框内很简单，只要进行两次判断（<code>LtMin&lt;lat&lt;LtMax; LnMin&lt;lng&lt;LnMax</code>），落在矩形框内的POI个数为n；</p>
<p>b)用球面距离公式计算位置与矩形框内n个POI的距离（图4b），并保留距离小于1000米的POI</p>
<p>矩形过滤方法的复杂度为：<code>POI数量*矩形过滤函数 + n*距离函数</code>。 </p>
<p><img src="23.png" alt></p>
<p>相比于方法一查询时间大大降低，但是对于一次查询来说还是很长。时间长的原因在于遍历。 </p>
<p>这时空间索引的需求就来了 </p>
<h3 id="空间索引思路"><a href="#空间索引思路" class="headerlink" title="空间索引思路"></a>空间索引思路</h3><p>要实现地理位置空间搜索，我们首先需要对地理位置数据创建索引，比较容易想到的就是把经度和纬度存入索引，可是这样做，有个弊端，因为地理位置数据(经纬度)是非常精细的，一般两个地点相差就0.0几，这样我们需要构建的索引体积会很大，这会显著减慢你的搜索速度。在精确度上采取折衷的方法通常是将纬度和经度封装到层中。您可以将每个层看作是地图的特定部分的缩放级别，比如位于美国中央上方的第 2 层几乎包含了整个北美，而第 19 层可能只是某户人家的后院。尤其是，每个层都将地图分成 2层 # 的箱子或网格。然后给每个箱子分配一个号码并添加到文档索引中。如果希望使用一个字段，那么可以使用 <strong>Geohash</strong>编码方式将纬度/经度编码到一个 String 中。关于GeoHash可以去看<a href="https://hogwartsrico.github.io/2015/01/22/About-GeoHash/">这篇文章</a>  </p>
<p>​    </p>
<h1 id="如何对地理数据建立索引"><a href="#如何对地理数据建立索引" class="headerlink" title="如何对地理数据建立索引"></a>如何对地理数据建立索引</h1><p>大家都知道普通的业务数据存入数据库(例如Oracle)或者全文检索引擎(例如Lucene,ElasticSearch)的时候都会建索引，因为索引会加快搜索速度。 但是地理数据如何建立空间索引呢？我有传统地理数据(例如cad,shp)如何存入数据库或全文检索引擎并建立索引呢？且听我慢慢讲来。</p>
<h1 id="shpfile介绍"><a href="#shpfile介绍" class="headerlink" title="shpfile介绍"></a>shpfile介绍</h1><p>通常,地理数据都是<a href="https://en.wikipedia.org/wiki/Shapefile" target="_blank" rel="noopener">ShapeFile</a> 格式的文件,GIS专业的童鞋应该对这个不陌生吧?说陌生的你老师棺材板我给你按住了，你赶紧复习复习  </p>
<p><img src="biaoqing_1.jpeg" alt></p>
<p>言归正传,shapefile它至少必须有3个文件,dbf ,shp shx. 通常由7个乃至更多文件组成  </p>
<p><img src="1.png" alt> </p>
<ul>
<li>主文件（<code>*.shp</code>） –存储地理要素的几何图形的文件。</li>
<li><a href="https://baike.baidu.com/item/%E7%B4%A2%E5%BC%95%E6%96%87%E4%BB%B6" target="_blank" rel="noopener">索引文件</a>（<code>*.shx</code>） –存储图形要素与属性信息索引的文件。</li>
<li>dBASE表文件（<code>*.dbf</code>），–存储要素信息属性的dBase表文件。</li>
<li>空间参考文件（<code>*.prj</code>）</li>
<li>几何体的空间索引文件（<code>*.sbn</code> 和 <code>*.sbx</code> )</li>
<li>以XML格式保存元数据（<code>*.shp.xml</code>)</li>
<li>.fix文件  </li>
</ul>
<p>此类文件如非使用专业的GIS软件例如 ArcMap, QGIS, Udig等是打不开的  </p>
<p>如非使用例如 GeoServer, ArcGIS Server等服务软件是无法对外部提供各种能力和接口的,例如获取瓦片图层，空间查询等  </p>
<p>空间数据和普通业务数据最大的不同就是业务数据基本上就是文本数据。例如电商的商品信息，信息系统的姓名年龄身高性别等,我们可以方便的对他们进行存储，分词等。 空间数据有着各种点，边 ，面，无法保存进传统数据库表的字段中 </p>
<p>然而,Oracle Spatial和PostgreSQL就提供了对空间数据的支持。它们可以导入shp数据，建立空间索引，提供了文本查询和空间查询 ，各大应用都可以通过数据库的协议来对空间数据进行增删查改,特别是查，不单单像普通业务数据那样可以进行查询，还可以进行空间查询，例如查找最近的餐馆，一个面和一个面是否相交，相交的面又是怎样的？ 这就大大开放了地理数据的能力。原来只能通过IO读取的shp文件，现在能提供给不同的业务系统进行增删查改  </p>
<p>Oracle Spatial和PG的确是解决了大部分的问题,但是比较麻烦，我得安装一个Oracle Spatial或PostgreSQL，导入数据，启动服务，项目连接配置。项目实施起来相对比较麻烦,Oracle Spatial还是商用收费的，只有企业版才有  </p>
<p>如果能有一种形式,无需起服务,Java应用能直接读取地理数据,而且已经现成的就建好了空间索引,能快速方便的进行属性查询，空间查询,那该多好，答案就是Lucene了  </p>
<p>一般Lucene被大家熟知都是因为它是性能强大的全文检索引擎,著名的分布式搜索引擎ElasticSearch就是基于Lucene写的，很少有人知道其实Lucene也提供了空间扩展，支持空间查询  </p>
<p><img src="24.png" alt></p>
<p>那么如何读取shp数据并存入lucene中呢？ </p>
<h1 id="shp存入Lucene"><a href="#shp存入Lucene" class="headerlink" title="shp存入Lucene"></a>shp存入Lucene</h1><h2 id="引入第三方包"><a href="#引入第三方包" class="headerlink" title="引入第三方包"></a>引入第三方包</h2><p>首先我们需要引入一些第三方的jar包  </p>
<p>我们介绍3个开源库 一个是<a href="http://geotools.org/" target="_blank" rel="noopener">GeoTools</a>  一个是<a href="https://en.wikipedia.org/wiki/JTS_Topology_Suite" target="_blank" rel="noopener">JTS</a>    一个是<a href="https://projects.eclipse.org/proposals/spatial4j" target="_blank" rel="noopener">Spatial4J</a>  </p>
<p>GeoTools是英国利兹大学(University of Leeds)的James Macgll 从1996 年开始研发的一个操作和显示地图的开源Java 代码库, 提供了一系列符合规范的操作地理空间数据的方法，例如可以用它来实现一个地理信息系统（GIS）。GeoTools库在开发时执行OGC规范.  很多工具和软件都使用了这个库 。 最著名的就是Udig和GeoServer </p>
<p>JTS加拿大的 Vivid Solutions公司做的一套开放源码的 Java API。它提供了一套空间数据操作的核心算法。提供了兼容OGC标准的空间对象模型中进行基础的几何操作 </p>
<p>Spatial4J是 空间拓扑计算的Java包 </p>
<p> 我们使用Maven引入GeoTools(GeoTools中已经引入了JTS)</p>
<pre><code class="xml">     &lt;geotools.version&gt;14.1&lt;/geotools.version&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.geotools&lt;/groupId&gt;
      &lt;artifactId&gt;geotools&lt;/artifactId&gt;
      &lt;version&gt;${geotools.version}&lt;/version&gt;
      &lt;type&gt;pom&lt;/type&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.geotools&lt;/groupId&gt;
      &lt;artifactId&gt;gt-main&lt;/artifactId&gt;
      &lt;version&gt;${geotools.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;&lt;!--提供了ShapeFile数据源支持 --&gt;
      &lt;groupId&gt;org.geotools&lt;/groupId&gt;
      &lt;artifactId&gt;gt-shapefile&lt;/artifactId&gt;
      &lt;version&gt;${geotools.version}&lt;/version&gt;
    &lt;/dependency&gt;
</code></pre>
<h2 id="Java读取ShapeFile文件"><a href="#Java读取ShapeFile文件" class="headerlink" title="Java读取ShapeFile文件"></a>Java读取ShapeFile文件</h2><pre><code class="java">         ShapefileDataStoreFactory shpStoreFactory = new ShapefileDataStoreFactory();//工厂模式,首先构造ShapefileDataStoreFactory
        ShapefileDataStore shapefileDataStore=null;
        try {
            shapefileDataStore = (ShapefileDataStore)shpStoreFactory.createDataStore(new File(&quot;/data/Airport_pt.shp&quot;).toURI().toURL());//打开一个shp文件连接到datastore
            shapefileDataStore.setCharset(Charset.forName(&quot;GBK&quot;));
        } catch (IOException e) {
            e.printStackTrace();
        }
        if(shapefileDataStore!=null){
            String names[]=shapefileDataStore.getTypeNames();//获取datastore中所有的shp,因为一个datastore可能存储了很多的shp
            System.out.println(Arrays.toString(names));
            SimpleFeatureSource featureSource = shapefileDataStore.getFeatureSource();
            //featureSource = dataStore.getFeatureSource(dataStore.getTypeNames()[0])//对于shp数据而言,等同于上面一行
            System.out.println(&quot;shp名称:&quot;+shapefileDataStore.getTypeNames()[0]);
            System.out.println(&quot;坐标系:&quot;+featureSource.getSchema().getGeometryDescriptor().getCoordinateReferenceSystem().toString());
   shapefileDataStore.dispose();//释放资源
</code></pre>
<p>DataStore有很多实现类</p>
<pre><code>AbstractDataStore, AbstractFileDataStore, ArcSDEDataStore, ArrayDataStore, CollectionDataStore, ContentDataStore, DataStoreWrapper, DirectoryDataStore,
JDBCDataStore, MemoryDataStore, OGRDataStore, OracleDatastoreWrapper, PostgisDatastoreWrapper, PreGeneralizedDataStore, PropertyDataStore,
ShapefileDataStore, SingleFeatureSourceDataStore, WFS100DataStore, WFS110DataStore
</code></pre><p>提供了多种数据源的支持,例如Oracle,PostgreSQL,ShapeFile,WFS,内存,目录等  ,我们这边使用的是<code>ShapefileDataStore</code>  </p>
<p><code>shpStoreFactory.createDataStore(URL url)</code>返回的是<code>FileDataStore</code> 并不是 <code>ShapefileDataStore</code> ,它有2个实现类<code>AbstractFileDataStore, ShapefileDataStore</code> 所以直接强转就行了 </p>
<p><code>DataStore.getTypeNames</code>:Returns the names of all entries or types provided by the datastore.</p>
<p>结果: </p>
<p><img src="2.png" alt></p>
<h2 id="Java读取shp内容"><a href="#Java读取shp内容" class="headerlink" title="Java读取shp内容"></a>Java读取shp内容</h2><pre><code class="java">             ArrayList&lt;Airport&gt; lists=new ArrayList&lt;Airport&gt;();
            try {
                SimpleFeatureIterator itertor = featureSource.getFeatures().features();
                while (itertor.hasNext()) {
                    Airport airport=new Airport();
                    SimpleFeature feature = itertor.next();///迭代里面的要素,例如如果是路的shp,那么就是迭代一条条路
                    Iterator&lt;Property&gt; it = feature.getProperties().iterator();//getProperties是获取某个条要素的属性信息(属性表)  迭代某条数据中的很多属性字段
                    while (it.hasNext()) {
                        Property pro = it.next();
                        switch (pro.getName().toString()){
                            case &quot;Name&quot;:
                                airport.setName(pro.getValue().toString());
                                break;
                            case &quot;Address&quot;:
                                airport.setAddress(pro.getValue().toString());
                                break;
                            case &quot;PY&quot;:
                                airport.setPY(pro.getValue().toString());
                                break;
                            case &quot;Display_X&quot;:
                                airport.setDisplay_X(pro.getValue().toString());
                                break;
                            case &quot;Display_Y&quot;:
                                airport.setDisplay_Y(pro.getValue().toString());
                                break;
                        }
                        if(pro.getValue() instanceof Point){//该shp里面是点
                            Point point=(Point)pro.getValue();
                            airport.setWKT(point.toText());
                        }
                    }
                    lists.add(airport);
                }
                itertor.close();
                System.out.println(&quot;数据条数:&quot;+lists.size());
            } catch (IOException e) {
                e.printStackTrace();
            }
</code></pre>
<p>如果是线, 多线 ,面 </p>
<pre><code class="java">if(pro.getValue() instanceof MultiLineString){
    MultiLineString lineString=(MultiLineString)pro.getValue();
    //lineString.getCoordinates();
    System.out.println(lineString.toText());
}
if(pro.getValue() instanceof LineString){
    MultiLineString lineString=(MultiLineString)pro.getValue();
    //lineString.getCoordinates();
    System.out.println(lineString.toText());
}
</code></pre>
<p><img src="3.png" alt></p>
<h2 id="存入lucene"><a href="#存入lucene" class="headerlink" title="存入lucene"></a>存入lucene</h2><pre><code class="java">         File luceneDir=new File(&quot;/data/lucene&quot;);//索引存放路径
        Path path= Paths.get(luceneDir.getAbsolutePath());
        Directory indexDirectory= FSDirectory.open(path);
        //------------------------构造wktreader,它需要JtsSpatialContext,由JtsSpatialContextFactory创建,这里要创建一个JtsSpatialContext,其需要一个Rectangle,其过程也创建了一个JtsSpatialContext,注意区分----------------------
        //JtsSpatialContextFactory 当有Polygon多边形或者linestrings线段时，会使用jts(需要把jts.jar放到solr服务的lib下)，而基本形状使用SpatialContext (spatial4j的类)。
        JtsSpatialContextFactory jtsSpatialContextFactory = new JtsSpatialContextFactory();//创建JtsSpatialContextFactory工厂类
        //spatial4j/jts实现的 SpatialContext: 用于获得距离计算Calculator以及解析形状等。其属于spatial4j包中，该包中还有各种Shape及判断各Shape间的相交情况。JtsSpatialContext(jts包)用于处理多边形等情况。
        jtsSpatialContextFactory.srid = 4326;// 赋予坐标系
        jtsSpatialContextFactory.autoIndex = true;// 对于通过 ShapeReader获取的jtsGeometry几何图形进行优化,自动索引
        // 根据srid不同获取不同的模型参数:4326采用椭球模型  sphere ,900913采用欧几里得平面坐标系flatPlane    4326不使用大地测量坐标系，而使用欧几里得平面坐标系进行计算
        String model = &quot;sphere&quot;;
        jtsSpatialContextFactory.geo = true;//是否是地理坐标系  如果是flatPlane则是false  jtsSpatialContextFactory继承自SpatialContextFactory这个字段一同继承过来的
        JtsSpatialContext jtsSpatialContext =new JtsSpatialContext(jtsSpatialContextFactory);//通过工厂创建  这样做只是为了创建一个Rectangle(世界模型,矩形),下面的new RectangleImpl需要用到
        Envelope env = new Envelope(-180, 180, 90, -90);// mecator的全 球范围 如果是900913 new Envelope(-20037508.3427892, 20037508.3427892, 20037508.3427892, -20037508.3427892);// mecator的全 球范围
        jtsSpatialContextFactory.worldBounds = new RectangleImpl(env.getMinX(), env.getMaxX(), env.getMinY(), env.getMaxY(), jtsSpatialContext);//为factory设置worldbounds，该属性来自父类SpatialContextFactory
        JtsSpatialContext ctx = jtsSpatialContextFactory.newSpatialContext();//最终用的是这个JtsSpatialContext
        WKTReader wktReader=new WKTReader(ctx, new SpatialContextFactory());//SpatialContext: 用于获得距离计算Calculator以及解析形状等。其属于spatial4j包中，该包中还有各种Shape及判断各Shape间的相交情况。JtsSpatialContext(jts包)用于处理多边形等情况。
        //-------------------构造wktreader结束--------------------

        //-----------------构造SpatialStrategy---------------------
        SpatialPrefixTree spt = new GeohashPrefixTree(ctx, 23);//网格最大几层 最大精度24层
        //如果是900913  new QuadPrefixTree(ctx, ctx.getWorldBounds(), 23);//四叉树，对应笛卡尔分层策略)。分层其实取的就是前缀
        SpatialStrategy strategy = new RecursivePrefixTreeStrategy(spt, &quot;Geometry&quot;);
        /*索引和搜索的策略接口,两个主要实现类
        * 1:RecursivePrefixTreeStrategy(支持任何Shape的索引和检索)
        * 2: TermQueryPrefixTreeStrategy(仅支持Point Shape)
        * 上述两个类继承PrefixTreeStrategy(有使用缓存)
        */
        //SpatialStrategy: 空间索引的核心，用来创建 索引域 以及 查询Query、查询Filter，以及用于score=distance等的打分策略(DistanceValueSource)。
        IndexWriter indexWriter = new IndexWriter(indexDirectory,new IndexWriterConfig(new SmartChineseAnalyzer(true)));
        for(int i=0;i&lt;lists.size();i++){
            Document doc = new Document();// org.apache.lucene.document // document代表索引库中的一条记录
            StringField nameField= new StringField(&quot;Name&quot;,lists.get(i).getName(), Field.Store.YES);//名字 存储
            doc.add(nameField);
            StringField addressField= new StringField(&quot;Address&quot;,lists.get(i).getAddress(), Field.Store.YES);//地址 存储
            doc.add(addressField);
            StringField pyField= new StringField(&quot;PY&quot;,lists.get(i).getPY(), Field.Store.YES);//拼音 存储
            doc.add(pyField);
            StringField xField= new StringField(&quot;X&quot;,lists.get(i).getDisplay_X(), Field.Store.YES);//X 存储
            doc.add(xField);
            StringField yField= new StringField(&quot;Y&quot;,lists.get(i).getDisplay_Y(), Field.Store.YES);//X 存储
            doc.add(yField);
            SortedDocValuesField sortedField = new SortedDocValuesField(&quot;PYName&quot;, new BytesRef(lists.get(i).getPY()));// 根据name进行排序
            doc.add(sortedField);
            /* ---------------------------空间字段------------------------ */
            // 空间字段，需要转换为shape后存储
            Shape shp=null;
            try {
                shp = wktReader.parse(lists.get(i).getWKT());
                /*
                 * 注意,检索但不存储空间字段。 org.apache.lucene.spatial.SpatialStrategy类
                 * createIndexableFields(org.locationtech.spatial4j.shape.Shape * shape) 返回值 abstract Field[] Returns the IndexableField(s) from
                 * the shape that are to be added to the Document
                 */
                for (Field shpField : strategy.createIndexableFields(shp)) {
                    doc.add(shpField);
                }
                StoredField wkt = new StoredField(&quot;wkt&quot;, lists.get(i).getWKT());//wkt存储
                doc.add(wkt);
            } catch (ParseException e) {
                e.printStackTrace();
            }
            indexWriter.addDocument(doc);
        }
        indexWriter.close();
</code></pre>
<p><strong>一些函数api</strong>  </p>
<p>生成一个默认的context</p>
<p><img src="16.png" alt></p>
<p>生成一个基于各种配置的context</p>
<p><img src="17.png" alt></p>
<pre><code>JtsSpatialContextFactory 也是继承的 SpatialContextFactory
</code></pre><p>执行程序,可以发现目录中已经有索引文件了  </p>
<p><img src="4.png" alt></p>
<p>我们使用Luke工具来查看Lucene索引文件  </p>
<p><img src="5.png" alt></p>
<p><img src="6.png" alt></p>
<p>我们上面代码写到我们生成了23层geohash网格，我们使用luke工具查看一下是否是23层   </p>
<p><img src="18.png" alt></p>
<p><img src="19.png" alt></p>
<p>果然是23层 </p>
<p>至此,空间数据索引并存储进Lucene完成了，接下来就要基于这些索引文件进行空间搜索了 </p>
<p>PS:关于Lucene内部是如何实现存储,索引空间数据后续会有博文讲述</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://dataknocker.github.io/2014/04/11/solr%E7%A9%BA%E9%97%B4%E7%B4%A2%E5%BC%95%E5%8E%9F%E7%90%86%E5%8F%8A%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">solr空间索引原理及源码分析</a>   </p>
<p><a href="https://tech.meituan.com/solr-spatial-search.html" target="_blank" rel="noopener">Solr空间搜索原理分析与实践</a>   </p>
<p><a href="http://www.cnblogs.com/hanfight/p/5776769.html" target="_blank" rel="noopener">Lucene Spatial构建地理空间索引</a>  </p>
<p><a href="https://wiki.apache.org/solr/SolrAdaptersForLuceneSpatial4" target="_blank" rel="noopener">https://wiki.apache.org/solr/SolrAdaptersForLuceneSpatial4</a>  </p>
<p><a href="https://sourceforge.net/projects/jts-topo-suite/" target="_blank" rel="noopener">https://sourceforge.net/projects/jts-topo-suite/</a>  </p>
<p><a href="https://lucene.apache.org/core/7_2_1/spatial-extras/index.html" target="_blank" rel="noopener">https://lucene.apache.org/core/7_2_1/spatial-extras/index.html</a></p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            This blog is under a CC BY-NC-SA 3.0 Unported License
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="http://hogwartsrico.github.io/2017/03/20/Index-SpatialData/">http://hogwartsrico.github.io/2017/03/20/Index-SpatialData/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/03/21/SpatialSearch-By-Lucene/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/09/12/Compile-And-Install-PostgreSQL-PostGIS/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Rico's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        chenhongjie101@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:chenhongjie101@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2024/03/">三月 2024<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2023/12/">十二月 2023<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2023/11/">十一月 2023<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2023/09/">九月 2023<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2023/03/">三月 2023<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/12/">十二月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/08/">八月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/07/">七月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/06/">六月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/03/">三月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/02/">二月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/12/">十二月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/12/">十二月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/08/">八月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">10</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/10/">十月 2019<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/05/">五月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/03/">三月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/02/">二月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/01/">一月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/04/">四月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/01/">一月 2015<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    
        <li>
            <a href="/photography" title="Photography">
                
                    <i class="material-icons sidebar-material-icons">photo</i>
                
                Photography
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">61</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/Ricoccc" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/rico.austin.5" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://plus.google.com/u/0/103668464393164710629" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    
        <a href="https://weibo.com/1878017080/profile" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    
        <a href="https://www.instagram.com/hogwartsrico/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-instagram">
                <span class="visuallyhidden">Instagram</span>
            </button><!--
     --></a>
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/HogwartsRico" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    
        <a href="https://space.bilibili.com/14573494" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-bilibili">
                <span class="visuallyhidden">Bilibili</span>
            </button><!--
     --></a>
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    
        <a href="https://v2ex.com/member/Rico" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-v2ex">
                <span class="visuallyhidden">V2EX</span>
            </button><!--
     --></a>
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;Rico's Blog
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>-->
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?wgjW/HuQG9JDgvPDPoRAng==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?LT4t6iE6m8TO1BLGGiNJqA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("sm_js","/js/smoothscroll.js?tNQK2Tw2SUL8a1Scn/Mgew==", true)</script>
    











<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('
<link rel="stylesheet" href="/css/uc.css">
');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->

<script type="text/ls-javascript" id="Bing-Background-script">
    queue.offer(function(){
        $('body').attr('data-original', 'https://api.i-meto.com/bing?');
    });
</script>


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2014;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
