<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">







    <link rel="dns-prefetch" href="https://hm.baidu.com">



    <link rel="dns-prefetch" href="https://fonts.googleapis.com">





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            自己实现一个简单的Spring容器 | 
        
        Rico&#39;s Blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="description" itemprop="description" content>
    <meta name="keywords" content="HogwartsRico,Spring">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?uVzgA6RLrOm13Ukw8Qgy+A==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/github-v2.min.css?AfzKxt++K+/lhZBlSjnxwg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body {
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?ezyEvm8ST5CGfpA+kFFi1g==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Rico&#39;s Blog">
    <meta name="msapplication-starturl" content="http://hogwartsrico.github.io/2018/11/11/write-a-spring/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Rico&#39;s Blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://hogwartsrico.github.io/2018/11/11/write-a-spring/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="自己实现一个简单的Spring容器 | Rico&#39;s Blog">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content>
    <meta property="og:article:tag" content="Spring"> 

    
        <meta property="article:published_time" content="Sun Nov 11 2018 22:59:23 GMT+0800">
        <meta property="article:modified_time" content="Sun Dec 19 2021 18:34:24 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://hogwartsrico.github.io/2018/11/11/write-a-spring/index.html">
    

    <!-- Structured-data for SEO -->
    

    <!-- Analytics -->
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?54ee66f82cedec3c2b6b4ea942911185';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#为什么要手写"><span class="post-toc-number">1.</span> <span class="post-toc-text">为什么要手写:</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#手写后会怎样"><span class="post-toc-number">2.</span> <span class="post-toc-text">手写后会怎样</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#经典问题"><span class="post-toc-number">3.</span> <span class="post-toc-text">经典问题</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#实战"><span class="post-toc-number">4.</span> <span class="post-toc-text">实战</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 28 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                自己实现一个简单的Spring容器
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Rico</strong>
        <span>11月 11, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Spring/">Spring</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=自己实现一个简单的Spring容器&url=http://hogwartsrico.github.io/2018/11/11/write-a-spring/index.html&pic=http://hogwartsrico.github.io/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=自己实现一个简单的Spring容器&url=http://hogwartsrico.github.io/2018/11/11/write-a-spring/index.html&via=Rico" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://hogwartsrico.github.io/2018/11/11/write-a-spring/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="为什么要手写"><a href="#为什么要手写" class="headerlink" title="为什么要手写:"></a>为什么要手写:</h1><p>1提升编码质量与水准</p>
<p>2可借鉴框架开发与设计思想</p>
<p>3代码重构提供参考依据</p>
<h1 id="手写后会怎样"><a href="#手写后会怎样" class="headerlink" title="手写后会怎样"></a>手写后会怎样</h1><p>透彻理解代码的实现原理</p>
<p>提高解决问题的效率</p>
<p>锻炼自己造轮子的能力</p>
<h1 id="经典问题"><a href="#经典问题" class="headerlink" title="经典问题"></a>经典问题</h1><p>1 什么是Spring框架，Spring框架有哪些主要模块?<br>2 使用Spring框架能带来哪些好处?<br>3 什么是控制反转?<br>4 BeanFactory和ApplicationContext有什么区别?<br>5 请解释Spring Bean的生命周期<br>6 Spring Bean的各种作用于之间有什么区别?<br>7 Spring框架中的单例Beans是线程安全的吗？   </p>
<p><img src="1.png" alt> </p>
<p>默认是用类名的首字母小写作为key，用类的实例作为值 ，保存到IOC容器中去 </p>
<h1 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h1><p>下面的代码还没有实现handlerMapping，但是对加载配置文件, 注解的扫描, bean实例化, 把bean塞入ioc容器 ,autowired都实现了</p>
<pre><code class="java">package org.rico.learnSpring.framework.webmvc.servlet;
import org.rico.learnSpring.framework.annotation.MyAutowired;
import org.rico.learnSpring.framework.annotation.MyController;
import org.rico.learnSpring.framework.annotation.MyService;
import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.File;
import java.io.IOException;
import java.io.InputStream;
import java.lang.reflect.Field;
import java.net.URL;
import java.util.*;
/**
 * Created by Rico on 2018/11/11.
 */
public class MyDispatcherServlet extends HttpServlet{
    private Properties contextConfig=new Properties();
    private List&lt;String&gt; classNames=new ArrayList&lt;String&gt;();
    private Map&lt;String,Object&gt; ioc=new HashMap&lt;String,Object&gt;();
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        this.doGet(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        super.doPost(req, resp);
    }

    @Override
    public void init(ServletConfig config) throws ServletException {
        //从这里开始启动SpringMVC
        //1 加载配置文件
        doLoadConfig(config.getInitParameter(&quot;contextConfigLocation&quot;));
        //2 扫描所有相关的类
        doScanner(contextConfig.getProperty(&quot;scanPackage&quot;));
        //3 初始化所有扫描到的类
        try {
            doInstance();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        }
        //4  自动注入
        doAutowired();
        //*******Spring到此初始化完成*********************************
        //*******以下属于SpringMVC的内容*****************************
        //5 初始化HandlerMapping
        initHandlerMapping();
        System.out.println(&quot;MySpring init end&quot;);
    }

    //载入配置
    private void doLoadConfig(String contextConfigLocation) {
        InputStream is=this.getClass().getClassLoader().getResourceAsStream(contextConfigLocation);
        try {
            contextConfig.load(is);
        } catch (IOException e) {
            e.printStackTrace();
        }finally {
            try {
                if(is!=null){
                    is.close();
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    //扫描类
    private void doScanner(String scanPackage){//传入的参数是哪些包需要扫描的
        URL url= this.getClass().getClassLoader().getResource(&quot;/&quot;+scanPackage.replaceAll(&quot;\\.&quot;,&quot;/&quot;));//把点替换成斜杠
        File classDir=new File(url.getFile());//拿到这个包下面的所有class
        for(File file : classDir.listFiles()){
            if(file.isDirectory()){//如果是文件夹，还需要继续搜寻，递归调用自身
                doScanner(scanPackage+&quot;.&quot;+file.getName());//递归
            }else{//如果不是文件夹
                String className=scanPackage+&quot;.&quot;+file.getName().replace(&quot;.class&quot;,&quot;&quot;);//把.class这个后缀去掉 
                classNames.add(className);
            }
        }
    }

    //实例化扫描到的类
    private void doInstance() throws IllegalAccessException, InstantiationException {
        if(classNames.isEmpty()){return;}
        for(String className:classNames){
            try {
                Class&lt;?&gt; clazz=Class.forName(className);//拿到class类
                //不是所有的类都要实例化，只实例化加了注解的类
                if(clazz.isAnnotationPresent(MyController.class)){
                    //把类初始化，然后放到IOC容器中
                    //key是类名首字母小写
                    String beanName=lowerFirstCase(clazz.getName());
                    ioc.put(beanName,clazz.newInstance());
                }else if(clazz.isAnnotationPresent(MyService.class)){//如果是Service注解
                    //默认采用首字母
                    //自定义bean的name，优先使用自定义的名字
                    //根据接口类型来赋值(接口不能实例化，但是接口的实现类可以实例化)
                    MyService service= clazz.getAnnotation(MyService.class);//拿到这个类上的@MyService注解
                    String beanName=service.value();
                    if(&quot;&quot;.equals(beanName.trim())){//如果beanName是空的话，那么说明用户没有自定义beanName,那么就用首字母小写作为beanName
                        beanName=lowerFirstCase(clazz.getName());
                    }
                    Object instance = clazz.newInstance();
                    ioc.put(beanName,instance);//将其放入ioc
                    for(Class&lt;?&gt; i:clazz.getInterfaces()){//获取这个类的接口 如果这个类有多个接口，那么需要报错，这里没做
                        ioc.put(i.getName(),instance);//key是这个接口的名称
                        //疑问,这个接口名不需要首字母小写作为key吗?
                    }
                    //所以有可能出现这种情况,就是以这个interface作为key的有一个实例，以类首字母小写作为key也有一个实例，且实例是同一个,主要是为了满足用户不同的注入要求
                }else{
                    continue;
                }
            } catch (ClassNotFoundException e) {
                e.printStackTrace();
            }
        }
    }

    //注入
    private void doAutowired() {
        if(ioc.isEmpty()){return;}
        //循环IOC容器中所有类，然后对需要自动赋值的属性进行赋值
        for(Map.Entry&lt;String,Object&gt; entry:ioc.entrySet()){
            //依赖注入，不管是谁，只要加了@MyAutowired注解的都要注入,哪怕它是私有的，哪怕他是受保护的.为什么？是因为反射破坏了它的封装性,在反射面前，所有东西都是裸露的. 所以反射要慎用，一般在框架里或者底层的设计模式中使用
            Field[] fields=entry.getValue().getClass().getDeclaredFields();//获取所有的字段
            for(Field field:fields){//找出有@MyAutowired的注解的字段
                if(!field.isAnnotationPresent(MyAutowired.class)){ continue; }
                MyAutowired autowired=field.getAnnotation(MyAutowired.class);
                String beanName=autowired.value().trim();
                if(&quot;&quot;.equals(beanName)){//如果没有指定引用那个bean,那么就是它的类型的那个bean
                    beanName=field.getType().getName();
                }
                //暴力访问
                field.setAccessible(true);
                try {
                    field.set(entry.getValue(),ioc.get(beanName));//给这个字段复制,第一个参数是这个字段所在的对象实例,第二个参数就是具体的值
                } catch (IllegalAccessException e) {
                    e.printStackTrace();
                    continue;
                }
            }
        }
    }
    private void initHandlerMapping() {
    }

    //首字母小写工具类
    private String lowerFirstCase(String str){
        String firstString=str.substring(0, 1);
        firstString=firstString.toLowerCase();
        String left=str.substring(1,str.length());
        return firstString+left;
    }
}
</code></pre>
<p><img src="2.png" alt></p>
<p>这里明明代码只写了2个注解，一个是Controller,一个是Service，怎么有三个bean？</p>
<p>是因为把service的实现和接口都作为了一个bean的key，这样不管是用接口去注入还是用实现去注入都可以注入成功 </p>
<p>接下来实现initHandlerMapping方法</p>
<pre><code class="java">    private void initHandlerMapping() {
        if(ioc.isEmpty()) {return; }
        //扫描所有的bean
        for(Map.Entry&lt;String,Object&gt; entry : ioc.entrySet()){
            //找到注解在类上的RequestMapping,拿到它的值
            Class&lt;?&gt; clazz=entry.getValue().getClass();
            if(!clazz.isAnnotationPresent(MyController.class)){continue;}//只针对Controller,如果不是Controller,加了RequestMapping就忽略
            String baseUrl=&quot;&quot;;//类上注解的requestMapping,是基url
            if(clazz.isAnnotationPresent(MyRequestMapping.class)){
                MyRequestMapping requestMapping=clazz.getAnnotation(MyRequestMapping.class);
                baseUrl=requestMapping.value();
            }
            //扫描所有的公共方法
            for(Method method:clazz.getMethods()){
                if(!method.isAnnotationPresent(MyRequestMapping.class)){ continue; }
                MyRequestMapping myRequestMapping=method.getAnnotation(MyRequestMapping.class);
                String methodUrl=(&quot;/&quot;+baseUrl+myRequestMapping.value()).replaceAll(&quot;/+&quot;,&quot;/&quot;);//把连续的斜杠处理成单个斜杠
                handlerMapping.put(methodUrl,method);
                System.out.println(&quot;Mapping :&quot;+methodUrl+&quot;,&quot;+method);//打印日志
            }
        }
    }
</code></pre>
<p>测试类</p>
<pre><code class="java">@MyController
@MyRequestMapping(&quot;/demo&quot;)
public class Demo {
    @MyAutowired
    private IDemoService demoService;
    @MyRequestMapping(&quot;/query&quot;)
    public void query(HttpServletRequest request, HttpServletResponse response, @MyRequestParam(&quot;name&quot;) String name){
        String result=demoService.get(name);
        try{
            response.getWriter().write(result);
        }catch (IOException e){
            e.printStackTrace();
        }
    }
}
</code></pre>
<p>输出</p>
<p><img src="3.png" alt> </p>
<p>接下来实现doGet doPost </p>
<pre><code class="java">private Map&lt;String,Method&gt; handlerMapping = new HashMap&lt;String,Method&gt;();
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //this.doGet(req, resp);
        this.doPost(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //super.doPost(req, resp);
        doDispatch(req,resp);
    }

    private void doDispatch(HttpServletRequest req, HttpServletResponse resp) throws IOException {
        String url=req.getRequestURI();
        String contextPath=req.getContextPath();
        url=url.replaceAll(contextPath,&quot;&quot;).replaceAll(&quot;/+&quot;,&quot;/&quot;);//把多余的斜杠替换掉
        if(!handlerMapping.containsKey(url)) {//如果url在handlerMapping没有的话就返回404
            resp.getWriter().write(&quot;&lt;h1&gt;404 not found&lt;/h1&gt;  --By Rico&quot;);
            return;
        }
        Method method=handlerMapping.get(url);//拿到这个url对应的方法
        method.invoke(这里遇到了问题)//第一个参数是谁调这个方法,第二个参数就是方法参数
        System.out.println(method);
    }
</code></pre>
<p>到此，除了调用哪个url对应的method，其他步都完成了,比如url请求处理</p>
<p>当请求到了该url会打印这个方法</p>
<p><img src="5.png" alt> </p>
<p>不存在的url会404 </p>
<p><img src="4.png" alt></p>
<p>但是此时在调用method.invoke的时候出了问题，因为调用那个method的bean被弄丢了，所以handlerMapping不能用map，得改下，把那个bean也纳入进来了</p>
<p>修改后的完整的MyDispatcherServlet的代码</p>
<pre><code class="java">package org.rico.learnSpring.framework.webmvc.servlet;
import org.rico.learnSpring.framework.annotation.*;
import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.File;
import java.io.IOException;
import java.io.InputStream;
import java.lang.annotation.Annotation;
import java.lang.reflect.Field;
import java.lang.reflect.Method;
import java.net.URL;
import java.util.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * Created by Rico on 2018/11/11.
 */
public class MyDispatcherServlet extends HttpServlet{
    private Properties contextConfig=new Properties();
    private List&lt;String&gt; classNames=new ArrayList&lt;String&gt;();
    private Map&lt;String,Object&gt; ioc=new HashMap&lt;String,Object&gt;();
    //private Map&lt;String,Method&gt; handlerMapping = new HashMap&lt;String,Method&gt;();
    private  List&lt;Handler&gt; handlerMapping=new ArrayList&lt;Handler&gt;();
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //this.doGet(req, resp);
        this.doPost(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //super.doPost(req, resp);
        try {
            doDispatch(req,resp);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void doDispatch(HttpServletRequest req, HttpServletResponse resp) throws Exception {
        try{
            Handler handler=getHandler(req);
            if(handler==null){//如果没有匹配
                resp.getWriter().write(&quot;&lt;h1&gt;404 not found&lt;/h1&gt;  --By Rico&quot;);
                return;
            }
            //获取方法的参数列表
            Class&lt;?&gt; [] paramTypes=handler.method.getParameterTypes();
            //保存所有需要自动赋值的参数值
            Object[] paramValues=new Object[paramTypes.length];
            Map&lt;String,String[]&gt; params=req.getParameterMap();
            for(Map.Entry&lt;String,String[]&gt; param:params.entrySet()){
                String value=Arrays.toString(param.getValue()).replaceAll(&quot;\\[|\\]&quot;,&quot;&quot;).replaceAll(&quot;//&quot;,&quot;/&quot;);
                //如果找到匹配的对象,则开始填充参数值
                if(!handler.paramIndexMapping.containsKey(param.getKey())){continue;}
                int index=handler.paramIndexMapping.get(param.getKey());
                paramValues[index]=convert(paramTypes[index],value);
            }
            //设置方法中的request和response对象
            int reqIndex=handler.paramIndexMapping.get(HttpServletRequest.class.getName());
            paramValues[reqIndex]=req;
            int respIndex=handler.paramIndexMapping.get(HttpServletResponse.class.getName());
            paramValues[respIndex]=resp;
            handler.method.invoke(handler.controller,paramValues);//反射调用
        }catch (Exception e){
            throw  e;
        }
        /*
        String url=req.getRequestURI();
        String contextPath=req.getContextPath();
        url=url.replaceAll(contextPath,&quot;&quot;).replaceAll(&quot;/+&quot;,&quot;/&quot;);//把多余的斜杠替换掉
        if(!handlerMapping.containsKey(url)) {//如果url在handlerMapping没有的话就返回404
            resp.getWriter().write(&quot;&lt;h1&gt;404 not found&lt;/h1&gt;  --By Rico&quot;);
            return;
        }

        Method method=handlerMapping.get(url);//拿到这个url对应的方法
        method.invoke()//第一个参数是谁调这个方法,第二个参数就是方法参数
        System.out.println(method);*/
    }

    //从HttpServletRequest中通过url匹配handlermapping这个map中的元素来获取handler
    private Handler getHandler(HttpServletRequest req)throws Exception{
        if(handlerMapping.isEmpty()){return null;}
        String url=req.getRequestURI();
        String contextPath=req.getContextPath();
        url=url.replaceAll(contextPath,&quot;&quot;).replaceAll(&quot;/+&quot;,&quot;/&quot;);//把多余的斜杠替换掉
        for(Handler handler:handlerMapping){
            try{
                Matcher matcher=handler.pattern.matcher(url);//通过正则匹配url
                //如果没有匹配上 继续下一个匹配
                if(!matcher.matches()){continue;}
                return handler;
            }catch (Exception e){
                throw e ;
            }
        }
        return null;
    }

    private Object convert(Class&lt;?&gt; type,String value){
        if(Integer.class==type){
            return  Integer.valueOf(value);
        }
        return value;
    }
    @Override
    public void init(ServletConfig config) throws ServletException {
        //从这里开始启动SpringMVC
        //1 加载配置文件
        doLoadConfig(config.getInitParameter(&quot;contextConfigLocation&quot;));
        //2 扫描所有相关的类
        doScanner(contextConfig.getProperty(&quot;scanPackage&quot;));
        //3 初始化所有扫描到的类
        try {
            doInstance();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        }
        //4  自动注入
        doAutowired();

        //*******Spring到此初始化完成*********************************
        //*******以下属于SpringMVC的内容*****************************
        //5 初始化HandlerMapping
        initHandlerMapping();
        System.out.println(&quot;MySpring 初始化完成!&quot;);
    }

    //载入配置
    private void doLoadConfig(String contextConfigLocation) {
        InputStream is=this.getClass().getClassLoader().getResourceAsStream(contextConfigLocation);
        try {
            contextConfig.load(is);
        } catch (IOException e) {
            e.printStackTrace();
        }finally {
            try {
                if(is!=null){
                    is.close();
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    //扫描类
    private void doScanner(String scanPackage){//传入的参数是哪些包需要扫描的
        URL url= this.getClass().getClassLoader().getResource(&quot;/&quot;+scanPackage.replaceAll(&quot;\\.&quot;,&quot;/&quot;));//把点替换成斜杠
        File classDir=new File(url.getFile());//拿到这个包下面的所有class
        for(File file : classDir.listFiles()){
            if(file.isDirectory()){//如果是文件夹，还需要继续搜寻，递归调用自身
                doScanner(scanPackage+&quot;.&quot;+file.getName());//递归
            }else{//如果不是文件夹
                String className=scanPackage+&quot;.&quot;+file.getName().replace(&quot;.class&quot;,&quot;&quot;);//把.class这个后缀去掉 
                classNames.add(className);
            }
        }
    }

    //实例化扫描到的类
    private void doInstance() throws IllegalAccessException, InstantiationException {
        if(classNames.isEmpty()){return;}
        for(String className:classNames){
            try {
                Class&lt;?&gt; clazz=Class.forName(className);//拿到class类
                //不是所有的类都要实例化，只实例化加了注解的类
                if(clazz.isAnnotationPresent(MyController.class)){
                    //把类初始化，然后放到IOC容器中
                    //key是类名首字母小写
                    String beanName=lowerFirstCase(clazz.getName());
                    ioc.put(beanName,clazz.newInstance());
                }else if(clazz.isAnnotationPresent(MyService.class)){//如果是Service注解
                    //默认采用首字母
                    //自定义bean的name，优先使用自定义的名字
                    //根据接口类型来赋值(接口不能实例化，但是接口的实现类可以实例化)
                    MyService service= clazz.getAnnotation(MyService.class);//拿到这个类上的@MyService注解
                    String beanName=service.value();
                    if(&quot;&quot;.equals(beanName.trim())){//如果beanName是空的话，那么说明用户没有自定义beanName,那么就用首字母小写作为beanName
                        beanName=lowerFirstCase(clazz.getName());
                    }
                    Object instance = clazz.newInstance();
                    ioc.put(beanName,instance);//将其放入ioc
                    for(Class&lt;?&gt; i:clazz.getInterfaces()){//获取这个类的接口 如果这个类有多个接口，那么需要报错，这里没做
                        ioc.put(i.getName(),instance);//key是这个接口的名称
                        //疑问,这个接口名不需要首字母小写作为key吗?
                    }
                    //所以有可能出现这种情况,就是以这个interface作为key的有一个实例，以类首字母小写作为key也有一个实例，且实例是同一个,主要是为了满足用户不同的注入要求
                }else{
                    continue;
                }
            } catch (ClassNotFoundException e) {
                e.printStackTrace();
            }
        }
    }

    //注入
    private void doAutowired() {
        if(ioc.isEmpty()){return;}
        //循环IOC容器中所有类，然后对需要自动赋值的属性进行赋值
        for(Map.Entry&lt;String,Object&gt; entry:ioc.entrySet()){
            //依赖注入，不管是谁，只要加了@MyAutowired注解的都要注入,哪怕它是私有的，哪怕他是受保护的.为什么？是因为反射破坏了它的封装性,在反射面前，所有东西都是裸露的. 所以反射要慎用，一般在框架里或者底层的设计模式中使用
            Field[] fields=entry.getValue().getClass().getDeclaredFields();//获取所有的字段
            for(Field field:fields){//找出有@MyAutowired的注解的字段
                if(!field.isAnnotationPresent(MyAutowired.class)){ continue; }
                MyAutowired autowired=field.getAnnotation(MyAutowired.class);
                String beanName=autowired.value().trim();
                if(&quot;&quot;.equals(beanName)){//如果没有指定引用那个bean,那么就是它的类型的那个bean
                    beanName=field.getType().getName();
                }
                //暴力访问
                field.setAccessible(true);
                try {
                    field.set(entry.getValue(),ioc.get(beanName));//给这个字段复制,第一个参数是这个字段所在的对象实例,第二个参数就是具体的值
                } catch (IllegalAccessException e) {
                    e.printStackTrace();
                    continue;
                }
            }
        }
    }
    private void initHandlerMapping() {
        if(ioc.isEmpty()) {return; }
        //扫描所有的bean
        for(Map.Entry&lt;String,Object&gt; entry : ioc.entrySet()){
            //找到注解在类上的RequestMapping,拿到它的值
            Class&lt;?&gt; clazz=entry.getValue().getClass();
            if(!clazz.isAnnotationPresent(MyController.class)){continue;}//只针对Controller,如果不是Controller,加了RequestMapping就忽略
            String baseUrl=&quot;&quot;;//类上注解的requestMapping,是基url
            if(clazz.isAnnotationPresent(MyRequestMapping.class)){
                MyRequestMapping requestMapping=clazz.getAnnotation(MyRequestMapping.class);
                baseUrl=requestMapping.value();
            }
            //扫描所有的公共方法
            for(Method method:clazz.getMethods()){
                if(!method.isAnnotationPresent(MyRequestMapping.class)){ continue; }
                MyRequestMapping myRequestMapping=method.getAnnotation(MyRequestMapping.class);
                //String methodUrl=(&quot;/&quot;+baseUrl+myRequestMapping.value()).replaceAll(&quot;/+&quot;,&quot;/&quot;);//把连续的斜杠处理成单个斜杠
                //handlerMapping.put(methodUrl,method);
                String regex=(&quot;/&quot;+baseUrl+myRequestMapping.value()).replaceAll(&quot;/+&quot;,&quot;/&quot;);//把连续的斜杠处理成单个斜杠
                Pattern pattern=Pattern.compile(regex);//用了正则之后requestmapping就可以用正则的语法啦，例如/query* 表示query开头的都进行拦截
                handlerMapping.add(new Handler(pattern,entry.getValue(),method));//handler类型的构造函数的参数  第一个是正则 第二个是controller对象 第三个是方法Method
                System.out.println(&quot;Mapping :&quot;+regex+&quot;,&quot;+method);//打印日志
            }
        }
    }

    //首字母小写工具类
    private String lowerFirstCase(String str){
        String firstString=str.substring(0, 1);
        firstString=firstString.toLowerCase();
        String left=str.substring(1,str.length());
        return firstString+left;
    }



    private class Handler{
        protected  Object controller;//保存方法对应的实例
        protected Method method;//保存映射的方法
        protected Pattern pattern;
        protected Map&lt;String,Integer&gt; paramIndexMapping;//参数顺序
        protected Handler(Pattern pattern,Object controller,Method method){
            this.controller=controller;
            this.method=method;
            this.pattern=pattern;
            paramIndexMapping=new HashMap&lt;String,Integer&gt;();
            putParamIndexMapping(method);
        }

        private void putParamIndexMapping(Method method) {
            //提取方法中加了注解的参数
            Annotation[][] pa=method.getParameterAnnotations();//它返回的是个二维数组
            for(int i=0;i&lt;pa.length;i++){
                for(Annotation anno:pa[i]){
                    if(anno instanceof MyRequestParam){//就是找那个标注了MyRequestParam的注解的参数
                        String paramName=((MyRequestParam)anno).value();
                        if(!&quot;&quot;.equals(paramName.trim())){
                            paramIndexMapping.put(paramName,i);
                        }
                    }
                }
            }
            //提取方法中的request和response参数
            Class&lt;?&gt; [] paramTypes=method.getParameterTypes();
            for(int i=0;i&lt;paramTypes.length;i++){
                Class&lt;?&gt; type=paramTypes[i];
                if(type==HttpServletRequest.class||type==HttpServletResponse.class){
                    paramIndexMapping.put(type.getName(),i);
                }
            }
        }
    }
}
</code></pre>
<p>成功</p>
<p><img src="6.png" alt></p>
<p>目录结构<br><img src="7.png" alt></p>
<p>源码待上传github</p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 3px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p><strong>
                         
                            This blog is under a CC BY-NC-SA 3.0 Unported License
                        </strong>
                        <br>
                        <strong>本文链接：</strong><a href="http://hogwartsrico.github.io/2018/11/11/write-a-spring/">http://hogwartsrico.github.io/2018/11/11/write-a-spring/</a>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/12/20/write-a-dubbo/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2018/09/01/proxy-in-Spring/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Rico's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        chenhongjie101@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:chenhongjie101@gmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2022/07/">七月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/06/">六月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/03/">三月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/02/">二月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/12/">十二月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/12/">十二月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/08/">八月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">10</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/10/">十月 2019<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/05/">五月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/03/">三月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/02/">二月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/01/">一月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/02/">二月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/04/">四月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/01/">一月 2015<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">53</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/Ricoccc" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/rico.austin.5" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://plus.google.com/u/0/103668464393164710629" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    
        <a href="https://weibo.com/1878017080/profile" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    
        <a href="https://www.instagram.com/hogwartsrico/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-instagram">
                <span class="visuallyhidden">Instagram</span>
            </button><!--
     --></a>
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/HogwartsRico" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    
        <a href="https://space.bilibili.com/14573494" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-bilibili">
                <span class="visuallyhidden">Bilibili</span>
            </button><!--
     --></a>
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    
        <a href="https://v2ex.com/member/Rico" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-v2ex">
                <span class="visuallyhidden">V2EX</span>
            </button><!--
     --></a>
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;Rico's Blog
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>-->
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?wgjW/HuQG9JDgvPDPoRAng==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?LT4t6iE6m8TO1BLGGiNJqA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("sm_js","/js/smoothscroll.js?tNQK2Tw2SUL8a1Scn/Mgew==", true)</script>
    











<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->

<script type="text/ls-javascript" id="Bing-Background-script">
    queue.offer(function(){
        $('body').attr('data-original', 'https://api.i-meto.com/bing?');
    });
</script>


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2014;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
